\documentclass[10pt,a4paper,twoside]{scrreprt}
\usepackage[italian]{babel} 

%\input{classicthesis-config.tex} 
%\usepackage[eulerchapternumbers,%drafting,%pdfspacing,%
%            subfig,eulermath,parts]{classicthesis}
\pagestyle{headings}

\addtolength{\voffset}{9mm}   %>>> moves text field down
\usepackage[latin1]{inputenc}   % Encodage ISO-8859-1.
\usepackage{graphicx}
\graphicspath{{images/}} 
\newcommand{\keyevidence}[1]{\fbox{#1}}

% Smaller italic font for marginpars
\let\oldmarginpar\marginpar
\renewcommand\marginpar[1]{\-\oldmarginpar[\raggedleft\footnotesize\it #1]%
{\raggedright\footnotesize\it #1}}

\usepackage{pgf}
\usepackage{hyperref}

\definecolor{webgreen}{rgb}{0,.5,0}
\definecolor{webbrown}{rgb}{.6,0,0}
\definecolor{Maroon}{cmyk}{0, 0.87, 0.68, 0.32}
\definecolor{RoyalBlue}{cmyk}{1, 0.50, 0, 0}

\usepackage{listings} 
\usepackage{makeidx}
\lstdefinelanguage{FIDOCAD} 
	{morekeywords={LI,PP,PV,TY,TE,MC,EV,EP,RP,RV,BE,SA,PA,PL,CV,CP,FCJ,FJC,%
		[FIDOCAD],[FIDOLIB]}, 
	sensitive=false, 
	morecomment=[s]{[}{]}, 
	morecomment=[s][\color{blue}]{\{}{\}}, 
	morecomment=[l][\color{violet}]{*},
	moredelim=[il][\color{violet}]{£},
} 
\lstdefinelanguage{plain} 
	{morekeywords={}, 
	sensitive=false, 
} 
\lstset{frame=single,%
	backgroundcolor=\color{lightgray},
	keywordstyle=\color{RoyalBlue},
	breaklines=true
	}


\lstset{language=FIDOCAD,%
	basicstyle=\small\ttfamily} 

% *******************************************************
% Hyperreferences
% *******************************************************
\hypersetup{%
    colorlinks=true, linktocpage=true, pdfstartpage=3, pdfstartview=FitV,%
    breaklinks=true, pdfpagemode=UseNone, pageanchor=true, pdfpagemode=UseOutlines,%
    plainpages=false, bookmarksnumbered, bookmarksopen=true, bookmarksopenlevel=1,%
    hypertexnames=true, pdfhighlight=/O,%hyperfootnotes=true,%nesting=true,%frenchlinks,%
    urlcolor=webbrown, linkcolor=RoyalBlue, citecolor=green, %pagecolor=RoyalBlue,%
    % uncomment the following line if you want to have black links (e.g., for printing)
    %urlcolor=Black, linkcolor=Black, citecolor=Black, %pagecolor=Black,%
    pdftitle={FidoCadJ -- manuale d'uso},%
    pdfauthor={Davide Bucci},%
    pdfsubject={Come utilizzare FidoCadJ},%
    pdfkeywords={FidoCAD, FidoCadJ, CAD, schemi elettrici, circuiti stampati},%
    pdfcreator={pdfLaTeX},%
    pdfproducer={LaTeX with hyperref and classicthesis}%
}

\newcommand{\micron}{\,\mu\mathrm{m}}

\newcommand{\toprule}{\hline}

\newcommand{\midrule}{\hline}

\newcommand{\bottomrule}{\hline}
\title{\Huge\color{webbrown} FidoCadJ 0.24.1 \\ manuale dell'utente} 


\author{Davide Bucci\\[3em]
\includegraphics[width=.7\textwidth]{icona_fidocadj_a}
}

 \makeindex


\begin{document} 
\pagenumbering{roman}

%%\pdfbookmark[1]{Frontespizio}{Frontespizio}
\maketitle 

\clearpage
%%\pdfbookmark[1]{Licenza}{Licenza}
Quest'opera è soggetta alla Creative Commons Public License versione 3.0 
o posteriore. L'enunciato integrale della Licenza in versione 3.0 è reperibile 
all'indirizzo internet:\\
\href{http://creativecommons.org/licenses/by-nc-nd/3.0/deed.it}{http://creativecommons.org/licenses/by-nc-nd/3.0/deed.it}. 
 
 Si è liberi di riprodurre, distribuire, comunicare al pubblico, esporre, 
in pubblico, rappresentare, eseguire e recitare quest'opera alle seguenti 
condizioni: 
\begin{description}
\item[Attribuzione]{Bisogna attribuire la paternità dell'opera nei modi indicati 
dall'autore}
\item[Non commerciale]{Non si può usare quest'opera per fini commerciali. }
\item[Non opere derivate]{Non si può alterare o trasformare quest'opera, né
usarla per crearne un'altra. Ogni volta che si usa o si distribuisce quest'opera, lo si deve fare secondo i termini di questa licenza, che va comunicata con chiarezza. }
\end{description}
 In ogni caso si possono concordare con il titolare dei diritti d'autore (Davide Bucci) utilizzi di quest'opera non consentiti da questa licenza. 
\vfill
I nomi commerciali, i loghi, i trademark appartengono ai rispettivi proprietari.
 



\begingroup
%\let\clearpage\relax
%\let\cleardoublepage\relax
%\let\cleardoublepage\relax


\chapter*{Riassunto}

\pdfbookmark[1]{Riassunto}{Riassunto}
Questo documento è il manuale utente di FidoCadJ. Dopo una breve presentazione della storia del programma e della sua filosofia, verranno fornite le nozioni principali per disegnare un semplice schema elettrico ed un circuito stampato con FidoCadJ. La descrizione procederà poi con alcuni dettagli tecnici poco documentati altrove, come la descrizione completa del formato testuale usato da FidoCadJ. Infine, verranno fornite alcune indicazioni utili per scaricare ed installare FidoCadJ utilizzando i sistemi operativi più diffusi: Linux, MacOSX e Windows.

\endgroup			

\chapter*{Ringraziamenti}
\pdfbookmark[1]{Ringraziamenti}{Ringraziamenti}

Molte persone hanno utilizzato il programma (o una delle sue versioni preliminari) e mi hanno fatto avere le loro impressioni. Ringrazio quindi i frequentatori del newsgroup\index{newsgroup} it.hobby.elettronica\index{it.hobby.elettronica} per i loro consigli. Il programma è stato pazientemente testato sotto Linux da  Stefano Martini, che è stato un infaticabile scovatore di bug. Inoltre, ringrazio, Olaf Marzocchi ed Emanuele Baggetta per i test funzionali sotto MacOSX\index{MacOSX}. Ringrazio F. Bertolazzi di non avermi dato tregua fino a che FidoCadJ non è diventato un minimo decente e di aver lavorato per la libreria CadSoft Eagle\index{Eagle}.  Ringrazio Celsius per le prove effettuate su FidoCadJ e sulla libreria PCB\index{PCB} ed Andrea D'Amore per i consigli su come migliorare l'aspetto del programma su Apple Macintosh, a partire dalla versione 0.21.1. Un grazie particolare a Roby IZ1CYN per le discussioni sulle librerie e per aver scritto il paragrafo \ref{installazione_linux} di questo manuale, relativo all'installazione sotto Linux\index{linux} di FidoCadJ. Un grazie anche a Pasu, che si è preso la briga di tradurre in inglese tutto questo manuale e che ha corretto diversi refusi che avevo fatto traducendo l'interfaccia di FidoCadJ in questa lingua. Gli utenti Macintosh possono contare sul buon aspetto di FidoCadJ grazie al look and feel Quaqua\index{Quaqua}, frutto del lavoro di Werner Randelshofer. Werner ha anche fornito molti consigli sull'organizzazione dell'interfaccia utente di FidoCadJ: grazie!

Nell'aprile 2010, FidoCadJ è stato integrato all'interno del portale di elettronica \href{www.electroyou.it}{www.electroyou.it}\index{www.electroyou.it}. Ringrazio l'admin Zeno Martini, il webmaster Nicolò Martini e tanti utilizzatori per avermi fornito degli ottimi spunti per adattare FidoCadJ a girare in batch per convertire gli schemi sul loro server: è stata aperta una via molto interessante e promettente. Più di recente, la classe FidoReadPHP, capace di leggere ed interpretare i disegni FidoCadJ è stata adottata anche sul forum di \href{www.grix.it}{www.grix.it}\index{www.grix.it} grazie agli sforzi di Arniek e di Sstrix, che ringrazio.


\chapter*{FidoCadJ License}
\pdfbookmark[1]{Licenza FidoCadJ}{Licenza FidoCadJ}

 
Copyright \copyright\ 2007-2012  Davide Bucci \href{mailto:davbucci@tiscali.it}{davbucci@tiscali.it}
        
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3 of the License.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see \href{http://www.gnu.org/licenses/}{http://www.gnu.org/licenses/}.

\tableofcontents
\pdfbookmark[1]{Indice}{Indice}

\listoffigures
\pdfbookmark[1]{Elenco delle figure}{Elenco delle figure}

\begingroup
\let\clearpage\relax
\let\cleardoublepage\relax
\let\cleardoublepage\relax
\listoftables
\pdfbookmark[1]{Elenco delle tabelle}{Elenco delle tabelle}

\endgroup

\chapter{Introduzione}
\pagenumbering{arabic}
In questo capitolo, faremo rapidamente alcune considerazioni su FidoCadJ. In particolare, vedremo qual è la filosofia che vi sta alla base, per poi ripercorrere brevemente le tappe della sua creazione e sviluppo.

\section{La filosofia di FidoCadJ}

FidoCAD\index{FidoCAD} (senza la J alla fine!) era un software di disegno particolarmente adatto ad essere usato per tracciare semplicemente schemi elettrici e circuiti stampati. Può ancora essere scaricato gratuitamente dalla pagina dell'autore, Lorenzo Lutti\index{Lorenzo Lutti}:

\href{http://www.enetsystems.com/~lorenzo/fidocad.asp}{http://www.enetsystems.com/~lorenzo/fidocad.asp}

Il file generato dal programma contiene solo dei codici in formato testo ed è molto compatto, prestandosi quindi ad essere usato come formato di scambio presso le comunità Usenet. Purtroppo, il software esiste solo nella versione Windows\index{Windows}. Chi usa Linux\index{Linux} può utilizzare WInE\index{WInE}, ma chi come me usa un Macintosh, deve arrangiarsi. Quindi ho voluto dare un piccolo contributo scrivendo FidoCadJ (con la J alla fine, questa volta), un editor in Java\index{Java}, capace di visualizzare e modificare i disegni in formato FidoCAD\index{FidoCAD}. \marginpar{Del resto, penso che sia meglio darsi da fare, piuttosto che lagnarsi che sotto un sistema operativo alternativo a Windows\index{Windows} non si trova il tal programma. O no?}

Chi avesse già utilizzato FidoCAD\index{FidoCAD}, dovrebbe trovarsi abbastanza a suo agio con FidoCadJ. Il mio scopo è stato quello di fornire una soluzione minimalista alle esigenze di disegno e di sbroglio di semplici circuitini. Il tutto rispettando la filosofia del programma originale, che è quella di fornire un mezzo agile e senza troppi fronzoli. Naturalmente, il mio obiettivo è stato quello di raggiungere una compatibilità totale fra FidoCadJ e il FidoCAD\index{FidoCAD} per Windows\index{Windows} originale. Questo è stato fatto fin dove possibile, ma le esigenze degli utenti hanno ben presto portato ad introdurre delle estensioni rispetto al formato originale.

Fra i miei interessi compare la tipografia al calcolatore, ed in particolare il \LaTeX\index{LaTeX@\LaTeX}. Per questa ragione, FidoCadJ si distingue dal programma originale per la possibilità di esportare i disegni in diversi formati grafici vettoriali, fra cui il Postscript incapsulato (meglio noto come \textsc{EPS}\index{EPS}). Naturalmente, FidoCadJ può esportare anche verso il notissimo formato \textsc{PDF}\index{PDF}.

L'appendice~\ref{specifics} descrive brevemente fra le altre cose le procedure di installazione di FidoCadJ nei vari sistemi operativi.

\section{Storia di FidoCadJ}
Sono un appassionato di elettronica da molto tempo. 
Quando parecchi anni fa ho iniziato ad affacciarmi al mondo dei newsgroup\index{newsgroup} della gerarchia italiana, mi sono accorto che invece di utilizzare una grafica ASCII, la maggior parte degli schemi elettrici veniva fornita utilizzando il formato del programma FidoCAD per Windows\index{FidoCAD}. Non usando più questo sistema operativo\index{Windows} da molto tempo, ho deciso di fare uno sforzo per colmare la lacuna esistente.

La prima cosa che ho fatto è stata quindi di studiarmi in dettaglio il formato utilizzato dal FidoCAD\index{FidoCAD} e scrivere un'applet Java\index{Java} chiamata FidoReadJ\index{FidoReadJ}, capace di interpretarlo e mostrare il risultato all'interno di una pagina Web.
Ho fatto un po' di reverse engineering, ho cercato informazioni dappertutto per capire quali fossero le possibilità e le limitazioni del formato, ed infine mi sono scaricato e studiato i sorgenti in C++ (peraltro ben fatti e commentati) del FidoCAD originale.
Questo avveniva più o meno verso marzo 2007. Qualche mese più tardi, l'applet era pubblicata sul sito ed era stata ampiamente testata da una parte della comunità gravitante attorno al gruppo it.hobby.elettronica\index{it.hobby.elettronica} e it.hobby.fai-da-te\index{it.hobby.fai-da-te}.\footnote{FidoReadJ\index{FidoReadJ} è sempre disponibile all'indirizzo:\\ \href{http://davbucci.chez-alice.fr/index.php?argument=elettronica/fidoreadj/fidoreadj.inc}{http://davbucci.chez-alice.fr/index.php?argument=elettronica/fidoreadj/fidoreadj.inc}.}

Disponendo di un interprete\index{interprete}\marginpar{In realtà, era un pallino che avevo da un pezzo. Il primo tentativo che ho fatto di scrivere un CAD 2D risale al 1993.} del formato, il lavoro restante per arrivare ad un editor completo è stato mettere a punto la gestione dell'interfaccia utilizzatore e dei vari elementi di disegno\index{elemento}. Il grosso del lavoro si è protratto in varie fasi da gennaio a luglio 2008. FidoCadJ non è quindi un porting di FidoCAD per Windows, ma piuttosto una riscrittura totale del programma. A partire dalla versione 0.21 (pubblicata nel gennaio 2009), FidoCadJ propone delle estensioni\index{estensioni} rispetto al formato FidoCAD originale. Molta attenzione è stata fatta per mantenere comunque una compatibilità all'indietro, anche se a partire dalla versione 0.23 di fine dicembre 2009 sono state introdotte delle estensioni per cui è impossibile mantenere una compatibilità con FidoCAD\index{FidoCAD}. Si è quindi arrivati ad un punto in cui FidoCadJ può fare molte cose che il vecchio FidoCAD non prevedeva.

La mia scelta di Java\index{Java} è motivata dal fatto che ho cambiato troppe 
architetture e sistemi operativi negli ultimi anni (per ragioni che 
non sto qui ad elencare) ed ho scelto uno strumento che non mi legasse ad 
una particolare architettura per il futuro. Inoltre, Java era un linguaggio 
che conoscevo già piuttosto bene, mentre lo stesso non potevo dire di altre soluzioni multipiattaforma. 
Lo sforzo di imparare il framework Cocoa\index{Cocoa} sarebbe probabilmente 
ripagato da un aspetto migliore del programma sotto MacOSX\index{MacOSX}, ma avrebbe reso il programma non portabile, senza contare che NON sono un 
informatico ed il tempo che dedico a programmare non lo dedico 
all'elettronica. 

Del resto, la struttura del codice rivela che io non sono certo un purista di Java\index{Java} e della programmazione ad oggetti\index{programmazione ad oggetti} e certe soluzioni sono certamente più pragmatiche che eleganti.

Quello che conta, più che la scelta di questo o quel linguaggio, è 
secondo me l'impressione d'uso del programma da parte dell'utente 
finale. Per questo, sono molto attento ai suggerimenti, 
ed in particolare a scoprire i limiti del programma o i punti in cui è 
necessario migliorare qualcosa. 
Per riassumere, non credo che Java\index{Java} sia la panacea di tutti mali e 
neppure un linguaggio perfetto. Credo tuttavia che molta della sua 
cattiva nomea sia dovuta a programmi di pessima qualità scritti in 
quel linguaggio. Senza avere pretese di perfezione e restando 
nell'ambito delle mie possibilità informatiche che non sono certo 
illimitate, intendo fare in modo che FidoCadJ NON sia un programma di 
pessima qualità ed è per questo che ogni commento sull'usabilità del 
programma e su eventuali problemi individuati sarà quanto mai benvenuto.

A partire da novembre 2009, ho aperto un progetto FidoCadJ su SourceForge\index{SourceForge}.
Da lì si possono scaricare gli eseguibili ed anche questo manuale. Si può partecipare attivamente allo sviluppo del 
programma, scaricandosi il codice sorgente, utilizzando 
Subversion, oppure con il browser SVN fornito da SourceForge: 

 \href{http://fidocadj.svn.sourceforge.net/viewvc/fidocadj/}{http://fidocadj.svn.sourceforge.net/viewvc/fidocadj/} 

Per dare una mano allo sviluppo di FidoCadJ non occorre essere dei programmatori 
esperti: se volete, potete tradurre il programma in una lingua 
straniera, rileggere con attenzione i manuali per trovare 
inconsistenze o errori, curare la coerenza (e la traduzione) della 
libreria standard\dots\
Del tempo che dedico a FidoCadJ, solo una metà circa è dedicata al lavoro del codice. Il resto è costituito dalle risposte alle domande degli utenti e dal lavoro sulla documentazione.
Se vi va, potete anche partecipare al forum di FidoCadJ, scrivere una recensione del programma, suggerire miglioramenti e segnalare bug. Il punto da cui partire è la pagina SourceForge:

 \href{http://sourceforge.net/projects/fidocadj/}{http://sourceforge.net/projects/fidocadj/} 

\section{FidoCadJ ed il futuro}
Nell'aprile 2010, sono capitato quasi per caso in una discussione all'interno del forum del noto portale \href{www.electroyou.it}{www.electroyou.it}. Un utente, Giancarlo Boletti, peraltro piuttosto famoso in diversi altri ambiti, ha proposto di integrare uno strumento di editing degli schemi elettrici direttamente all'interno del forum, come già era stato fatto con \LaTeX\index{LaTeX@\LaTeX}. Dato che veniva menzionato FidoCadJ, mi sono iscritto al sito e mi sono offerto di collaborare. Dopo pochissimi giorni, grazie al lavoro del webmaster, il sistema è stato finalizzato: basta fare un copia/incolla in un messaggio a partire dal programma e contrassegnare il codice con un paio di tag. Il motore del forum si occupa di lanciare FidoCadJ in maniera silenziosa sul server e recuperare un'immagine convertita. In questo modo, chi solo legge la discussione non deve avere nulla di installato per vedere l'immagine. Tuttavia, qualora desiderasse modificare l'immagine esistente, con pochi click può ottenere il codice da cui partire a fare le modifiche. La figura~\ref{fig_discussione_electroyou} mostra una parte di un mio messaggio inviato ad \href{www.electroyou.it}{www.electroyou.it}.
Il sistema ha una praticità ed una flessibilità tale che sono stato il primo ad essere stupito dell'entusiasmo dimostrato dalla comunità di \href{www.electroyou.it}{www.electroyou.it}.\footnote{Per maggiori informazioni: \href{http://www.electroyou.it/darwinne/wiki/fidocadj}{http://www.electroyou.it/darwinne/wiki/fidocadj}
}

\begin{figure}
\includegraphics[width=\textwidth]{discussione_electroyou.png}
\caption{Una parte di un mio intervento sul forum di \href{www.electroyou.it}{www.electroyou.it}\index{www.electroyou.it}. Basta un solo click e si può ingrandire lo schema elettrico. Con un altro, si accede immediatamente al codice pronto da essere nuovamente modificato con FidoCadJ.}
\label{fig_discussione_electroyou}
\end{figure}



Il successo che il programma ha avuto su \href{www.electroyou.it}{www.electroyou.it}\index{www.electroyou.it} ha fatto nascere delle richieste altrove, ed in particolare su  \href{www.grix.it}{www.grix.it}\index{www.grix.it}, un altro portale italiano molto noto. In questo caso, dato che il server era attrezzato per far funzionare programmi in Java, è stata sviluppata la classe FidoReadPHP, una sorta di interprete scritto in PHP. Il progetto FidoReadPHP è pure lui open source ed è disponibile su SourceForge:

\href{https://sourceforge.net/projects/fidoreadphp/}{https://sourceforge.net/projects/fidoreadphp/}

Il risultato è simile a quanto si è ottenuto su \href{www.electroyou.it}{www.electroyou.it}, anche se le potenzialità grafiche delle librerie del PHP sono parecchio limitate rispetto a quanto offre Java.\footnote{Per maggiori informazioni: \href{http://www.grix.it/viewer.php?page=9335}{http://www.grix.it/viewer.php?page=9335}}
La figura~\ref{fig_fidocadj_grix3} mostra un esempio di tale tecnica.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_grix3.png}
\caption{Un esempio di integrazione di un disegno FidoCadJ all'interno di un post del forum di \href{www.grix.it}{www.grix.it}\index{www.grix.it}. Anche qui si può accedere con un click al sorgente del disegno.}
\label{fig_fidocadj_grix3}
\end{figure}

Credo che il futuro di FidoCadJ non sia di diventare sempre più complesso alla stregua di altri programmi di CAD elettronico, ma piuttosto vada curata sempre di più la possibilità di integrazione con gruppi di discussione e portali tecnici. L'esperienza ha mostrato che questo è possibile e l'entusiasmo degli utenti suggerisce che questa è la via da percorrere, proprio nello spirito dell'idea originale che ha fatto nascere il primo FidoCAD.

\chapter{Il disegno con FidoCadJ}

Usare FidoCadJ dovrebbe essere abbastanza intuitivo per chi abbia già usato un programma di disegno vettoriale\index{disegno vettoriale}. 
L'aspetto con MacOSX\index{MacOSX} è mostrato nella figura~\ref{fig_fidocadj};\marginpar{Gli utilizzatori Mac di lunga data noteranno che i menu sono al loro posto!} sotto altri sistemi operativi cambia qualche dettaglio (per esempio, la figura~\ref{fig_metal} mostra il risultato con il look and feel Metal\index{Metal} di Sun\index{Sun}), ma la filosofia resta la medesima. Vedremo quindi quali sono le funzionalità offerte dal programma, nonché gli elementi di disegno di base (le primitive)\index{primitiva}, a partire dai quali ogni disegno FidoCadJ può essere ottenuto.
\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_macosx.png}
\caption{Una tipica sessione di lavoro di FidoCadJ sotto MacOSX Tiger\index{MacOSX}. Nell'appendice~\ref{specifics}, sono descritte le peculiarità della versione specifica per Macintosh\index{Macintosh}.}
\label{fig_fidocadj}
\end{figure}

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_metal.png}
\caption{L'aspetto di FidoCadJ con il look and feel Metal\index{Metal}.}
\label{fig_metal}
\end{figure}


\section{Gli strumenti di disegno}
Nella barra dei comandi\index{barra dei comandi} (in alto), si trovano le funzioni più utilizzate, che permettono di creare e modificare un disegno. La tabella~\ref{tab_comandi} mostra un rapido riassunto delle funzionalità dei comandi disponibili e descrive le azioni possibili. Noterete che una volta che viene premuto un bottone, questo rimarrà premuto fino a quando non si selezionerà un altra funzione dalla barra.\marginpar{Questo modo di funzionare è ispirato alle vecchie radio a valvole ed ai commutatori in voga fino agli anni 70.}
Nella barra, è possibile scegliere quale elemento di disegno\index{elemento} verrà introdotto.\footnote{Per avere maggiori informazioni sul formato con cui gli elementi del disegno vengono memorizzati, riferitevi alla sezione~\ref{sec_primitive}.} Sulla destra, una lista attivabile con un click mostra il layer corrente (riferitevi al paragrafo~\ref{sec_layer} per maggiori informazioni).

La barra dei comandi\index{barra dei comandi} è parzialmente personalizzabile. In particolare, si può scegliere se mostrare in ogni bottone l'icona più il testo, oppure solo l'icona. Le icone sono inoltre disponibili in due formati selezionabili a piacere. Per scegliere queste impostazioni, basta andare nel menu ``File/Opzioni''.\footnote{Tranne su MacOSX, in cui questa voce si trova nel menu FidoCadJ e si chiama ``Preferenze''.} Le modifiche saranno attive al riavvio successivo del programma, dato che presumibilmente non si tratta di qualcosa che va cambiato tutti i giorni.
Le figure \ref{fig_fidocadj} e \ref{fig_metal} mostrano quanto si ottiene nella barra dei comandi (subito sotto il titolo della finestra), configurata per mostrare il testo e le icone, nella loro versione più piccola. 
Nella seconda riga, a partire da sinistra si vedono le impostazioni di zoom ed i bottoni ``Adatta'', ``Mostra griglia'' e ``Blocca sulla griglia''. Il primo permette di selezionare automaticamente le impostazioni di zoom più adatte a mostrare la totalità del disegno. Il secondo permette di selezionare se mostrare oppure no la griglia. Il terzo permette all'utente di scegliere se desidera allineare gli elementi alla griglia durante l'introduzione, oppure no. Una cosa che può essere utile per allineare con precisione degli oggetti senza dover disattivare la griglia è selezionare gli elementi da muovere e poi premere \keyevidence{Alt} ed i tasti cursore.

\begin{table}
\centering
\begin{tabular}{clp{.6\textwidth}}
\toprule
Tasto
&
Comando
&
Uso
\\
\midrule

\keyevidence{A}
o
\keyevidence{Spazio}

&

\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/arrow}%
}
 \textsc{Seleziona}\index{selezione}
&
Selezione di uno o più elementi grafici. 
\keyevidence{Control} o \keyevidence{Command} con MacOSX, per selezioni multiple o deselezionare un solo elemento. 
Click e trascinare per selezionare più elementi in un'area. 
\keyevidence{R} per ruotare la selezione. 
\keyevidence{S} per specchiare la selezione. 
Doppio click su un elemento per modificarne le proprietà. 
\\

&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/magnifier}%
}
\textsc{Zoom}\index{zoom}
&
Click con il pulsante sinistro per aumentare lo zoom. 
Click con il pulsante destro per diminuirlo.
\\

&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/move}%
}
\textsc{Sposta}\index{sposta}
&
Click e spostare il mouse per scorrere la porzione visualizzata.
\\

\keyevidence{L}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/line}%
}
\textsc{Linea}\index{linea}
&
Linea o una serie di linee. \keyevidence{Esc}, click destro o doppio click sinistro per terminare l'introduzione.
\\

\keyevidence{T}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/text}%
}
\textsc{Testo}\index{testo}
&
Riga di testo.
\\

\keyevidence{B}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/bezier}%
}
\textsc{Bézier}\index{Bézier}
&
Curva di Bézier.
\\

\keyevidence{P}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/polygon}%
}
\textsc{Poligono}\index{poligono}
&
Poligono pieno o vuoto. Doppio click o \keyevidence{Esc}, per terminare l'introduzione dei vertici.
\\

\keyevidence{K}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/complexcurve}%
}
\textsc{Curva}\index{curva}
&
Curva spline naturale cubica aperta o chiusa. Doppio click o \keyevidence{Esc}, per terminare l'introduzione dei vertici.
\\

\keyevidence{E}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/ellipse}%
}
\textsc{Ellisse}\index{ellisse}
&
Ellisse pieno o vuoto (tener premuto \keyevidence{Control} per ottenere un cerchio).
\\

\keyevidence{G}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/rectangle}%
}
\textsc{Rettangolo}\index{rettangolo}
&
Rettangolo pieno o vuoto.
\\

\keyevidence{C}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/connection}%
}
\textsc{Connessione}\index{connessione}
&
Connessione elettrica in uno schema.
\\

\keyevidence{I}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/pcbline}%
}
\textsc{Pista}\index{pista c. s.}
&
Pista di circuito stampato. La larghezza di default può essere modificata da ``File/Opzioni''.
\\

\keyevidence{Z}
&
\raisebox{-.2em}{%
\includegraphics[width=1em]{icons/pcbpad}%
}
\textsc{Piazzola}\index{piazzola c. s.}
&
Piazzola per circuito stampato. Le dimensioni di default possono essere modificate da ``File/Opzioni''.
\\
\bottomrule
\end{tabular}
\caption{Riassunto dei comandi di disegno di FidoCadJ. Il tasto nella colonna più a sinistra permette l'attivazione da tastiera. Un click destro permette di modificare l'elemento.}
\label{tab_comandi}
\end{table}

Sulla destra, sono mostrati sotto forma di albero gli elementi\index{macro} (chiamati macro) delle librerie caricate nel programma. Basta selezionare un elemento della libreria e poi fare click nel disegno per poterlo inserire. Le librerie di FidoCAD\index{FidoCAD} includono tutti i simboli classici degli schemi elettrici, nonché una buona collezione di footprint\index{circuito stampato!footprint} per circuiti stampati.
A partire dalla versione 0.22, un campo di testo con la lente visibile sopra la lista ad albero (vedere figura~\ref{fig_ricerca}) permette di ricercare rapidamente\index{ricerca in librerie} un elemento fra quelli presenti nelle librerie caricate dal programma.  Usando le frecce su e giù, è possibile navigare all'interno di tutti gli elementi trovati.

\begin{figure}
\centering
\includegraphics[width=.4\textwidth]{ricerca}
\caption{La possibilità di ricerca all'interno delle librerie caricate.}
\label{fig_ricerca}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=.7\textwidth]{param_testo}
\caption{La finestra dei parametri di un testo in un disegno FidoCadJ.}
\label{fig_param_testo}
\end{figure}

La figura~\ref{fig_param_testo} mostra un esempio di quello che si ottiene facendo doppio click, in modalità selezione\index{selezione}, su un elemento del disegno, in questo caso una stringa di testo.
All'interno della finestra, è possibile modificare ogni aspetto (coordinate, rotazione\dots) di ogni primitiva di disegno. Naturalmente, l'aspetto non sarà sempre il medesimo, poiché le informazioni che possono venir modificate dipenderanno dall'elemento grafico che si sta modificando.

\section{Disegniamo un semplice schema elettrico}
Per capire come va usato il programma, procederemo a disegnare un semplicissimo schema elettrico, come quello mostrato in figura~\ref{fig_schema}.
\begin{figure}
\centering
%\includegraphics[width=.5\textwidth]{schema}
\input{images/schema.pgf}
\caption{Ecco il nostro obiettivo: uno specchio di corrente che utilizza transistor NPN.}
\label{fig_schema}
\end{figure}
Per iniziare, lanciamo quindi il programma oppure, se è già in esecuzione, creiamo un nuovo disegno dal menu ``File/Nuovo disegno''.

Iniziamo quindi ad introdurre nel disegno i simboli dei due transistor\index{transistor}, che sono un po' il cuore del nostro schema. Per fare questo, dovremmo utilizzare le macro a disposizione nella libreria standard\index{libreria standard}, che è caricata per default e si trova sulla destra del programma. La macro che ci serve è chiamata ``NPN senza schermo'' e si trova nella categoria ``Diodi e transistor'', all'interno della ``Libreria standard''. Facendo click per selezionare la macro\index{macro} desiderata, è poi possibile introdurla dove si vuole all'interno del disegno (il programma mostra un'anteprima), facendo click una seconda volta nella posizione voluta.
A questo punto, dovremmo trovarci davanti una situazione simile a quella mostrata nella figura~\ref{fig_fidocadj_fase1}.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_fase1}
\caption{Incominciamo a disegnare un paio di transistor.}
\label{fig_fidocadj_fase1}
\end{figure}

Una cosa che si nota subito è che il transistor bipolare sulla sinistra non è orientato correttamente. Basta fare click su ``Seleziona'', nella barra degli strumenti, selezionare il transistor (apparirà verde, con tre punti di controllo\index{punto di controllo} identificati da dei quadratini rossi) e poi premere \keyevidence{S} per specchiarlo. Un'altra  possibilità è quella di premere il tasto \keyevidence{S} prima di introdurre il transistor nel disegno, quando questo è già stato selezionato nella lista dei simboli.
Otterremo quindi il risultato visibile in figura~\ref{fig_fidocadj_fase2}.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_fase2}
\caption{Selezioniamo e specchiamo con \keyevidence{S} il transistor a sinistra.}
\label{fig_fidocadj_fase2}
\end{figure}

Utilizzando lo strumento ``Linea'' nella barra degli strumenti\index{barra degli strumenti}, potremo completare qualche connessione elettrica, fino ad accorgerci di aver cominciato lo schema un po' troppo vicino ai bordi dell'area di disegno. Poco male: in modalità ``Seleziona'', potremo fare click in alto a sinistra e, sempre tenendo premuto il pulsante sinistro del mouse, trascinarlo in basso a destra. Apparirà un rettangolo con i bordi verdi, che indicherà che stiamo cercando di selezionare d'un colpo tutti gli elementi al suo interno. Dato che dobbiamo spostare tutto quello che abbiamo disegnato fino ad ora, dovremmo selezionarli dapprima tutti (come si vede in figura~\ref{fig_fidocadj_fase3}). A questo punto, basterà, sempre in modalità selezione, fare click su un elemento qualsiasi selezionato e trascinare tutto lo schema nella posizione voluta.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_fase3}
\caption{Siamo troppo in alto: selezioniamo tutto e spostiamoci più in basso.}
\label{fig_fidocadj_fase3}
\end{figure}

Continuiamo quindi ad introdurre le parti mancanti del circuito, in particolare un resistore\index{resistore} (Libreria standard/Componenti discreti/Resistore) ed il terminale di alimentazione positiva (Libreria standard/Simbologia di base/Terminale +). Quest'ultimo, andrà ruotato per fargli assumere l'orientazione voluta. Basterà selezionarlo e premere \keyevidence{R} fino ad ottenere il risultato desiderato. Dovremmo quindi avere qualcosa di simile alla figura~\ref{fig_fidocadj_fase4}.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_fase4}
\caption{Il circuito quasi terminato}
\label{fig_fidocadj_fase4}
\end{figure}

Manca ora solo l'introduzione delle stringhe di testo e della freccia rappresentante il verso della corrente. Per quest'ultima, c'è la macro ``Freccia'', in ``Libreria standard/Simbologia di base''. Per il testo, bisogna usare il bottone ``Testo''\index{testo} nella barra dei comandi e cliccare nel disegno alla posizione desiderata. Verrà introdotto un testo ``String'', di cui potranno essere modificate le caratteristiche, facendovi doppio click in modalità selezione. Riferitevi alla figura~\ref{fig_param_testo}. 
Il nome e il modello del transistor utilizzato (una coppia di transistor, in realtà) sono specificati all'interno dei campi ``Name'' e ``Value'' che si ottengono facendo doppio click in modalità ``Selezione'' sulla macro.\footnote{La possibilità di associare un nome ed un valore ad una macro, ovvero ad un simbolo di un componente, è in realtà un'estensione di FidoCadJ\index{estensione FidoCadJ} non presente nel FidoCAD originale\index{FidoCAD}. Vedere il paragrafo~\ref{FCJ_extension} per maggiori informazioni sulla compatibilità.} 
Una dimensione adatta per lavorare con i circuiti è 4 unità in verticale e 3 in orizzontale.
Il circuito finito è mostrato in figura~\ref{fig_fidocadj_fase5}.

\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_fase5}
\caption{Ecco come viene mostrato il circuito finito}
\label{fig_fidocadj_fase5}
\end{figure}

Per chi fosse curioso, ecco a cosa assomiglia il codice\index{codice} che descrive il circuito. Per vederlo, basta selezionare ``Testo del circuito'' dal menu ``Circuito''. Il tutto è pronto per essere copiato ed incollato su un messaggio di posta elettronica\index{posta elettronica}, in un newsgroup\index{newsgroup}, oppure un forum\index{forum}.
\begin{lstlisting} 
[FIDOCAD]
MC 95 65 0 0 280
FCJ
TY 115 60 4 3 0 0 0 * Q1B
TY 115 65 4 3 0 0 0 * LM394
MC 55 65 0 1 280
FCJ
TY 20 60 4 3 0 0 0 * Q1A
TY 20 65 4 3 0 0 0 * LM394
LI 55 65 95 65 0
LI 40 75 40 95 0
LI 110 75 110 95 0
LI 40 40 40 55 0
MC 40 30 0 0 115
LI 40 15 40 30 0
LI 30 15 40 15 0
MC 30 15 2 0 010
LI 40 50 60 50 0
LI 60 50 60 65 0
SA 60 65 0
SA 40 50 0
LI 110 45 110 55 0
LI 110 35 110 40 0
LI 110 25 110 30 0
MC 40 95 0 0 040
MC 110 95 0 0 040
TY 45 30 4 3 0 0 0 * 10 k
TY 115 50 4 3 0 0 0 * I
MC 110 50 1 0 074
\end{lstlisting} 
Se siete interessati a comprendere il formato, in questo manuale c'è una descrizione dettagliata al capitolo~\ref{chap_formato}.

Non è comunque obbligatorio passare per la finestra ``Testo del circuito''; basta infatti selezionare il disegno nell'editor ed incollarlo nel testo che si sta scrivendo: apparirà il codice\index{codice} automaticamente.

\section{I layer}
\label{sec_layer}
Una maniera di immaginare un layer\index{layer} è quello di un disegno fatto su un acetato trasparente. Il disegno finale sarà dato dalla sovrapposizione di più layer, che verranno sovrapposti come fogli di acetato. Ogni layer
è distinto da un colore e può essere disegnato, oppure no. Questo modo di lavorare è comune a molti sistemi di disegno elettronico, perché permette facilmente di rappresentare le diverse parti che poi verranno sovrapposte, per esempio in un circuito stampato\index{circuito stampato}.

FidoCadJ permette di utilizzare 16 layer, che sono numerati da 0 a 15. La funzione di ogni layer è basata su una convenzione ed in particolare, il layer zero sarà quello utilizzato per gli schemi elettrici\index{schemi elettrici}, il layer 1 per il rame lato saldature\index{saldature}, il layer 2 per il rame lato componenti ed il layer 3 per le serigrafie\index{serigrafia}. I restanti layer non sono associati ad una specifica funzione e potete usarli come meglio credete. Il nome ed il colore\index{colore} di ogni layer si può specificare attraverso il menu ``Vista/Layer''. Dallo stesso menu si può decidere se disegnare o meno un certo layer a schermo, oppure in stampa.

L'ordine dei layer è importante. In particolare, i layer con numero più basso vengono disegnati per primi. Disegni presenti su layer successivi potranno coprire quindi quanto presente sui layer più bassi.


\section{La griglia}
L'unità logica\index{unità logica} di FidoCadJ è di 5 mils (127 micron) e non si possono avere ``mezze unità'', nel senso che le coordinate di qualsiasi elemento grafico devono per forza essere intere. Questo permette di ottenere una risoluzione\index{risoluzione} sufficiente per disegnare uno schema elettrico e la maggior parte dei circuiti stampati. Per comodità, comunque, il programma può impostare una griglia\index{griglia} più larga e fare in modo che ogni operazione fatta con il mouse venga allineata al punto della griglia più vicino.
Per questa ragione, sono presenti due bottoni, ``Mostra griglia'' e ``Blocca sulla griglia'', che permettono appunto di mostrare il reticolato utilizzato e di attivare o meno l'operazione di "aggiustamento" sui punti della griglia. Il passo della griglia può essere scelto all'interno della finestra che si attiva dal menu "Vista" e poi "Opzioni".

\section{Disegniamo un semplice circuito stampato}
Per impratichirsi con tutto quanto visto fino ad ora, il modo migliore è vedere come fare a disegnare un circuito stampato usando FidoCadJ.
A differenza di altri programmi di CAD elettrico che sono indubbiamente molto potenti, ma anche piuttosto difficili da usare, FidoCadJ fornisce sostanzialmente una versione elettronica dei vecchi trasferibili R41\index{trasferibili R41}. Ovviamente, il fatto di lavorare su un calcolatore permette di beneficiare di tutta la flessibilità offerta dal mezzo.

Bisogna notare che il progetto di un circuito stampato\index{circuito stampato}, specie se complesso, non è affatto un compito semplice. \marginpar{Il lettore si faccia animo: un po' di ragionamenti fatti con carta e matita (e moltissime gomme) permettono a conti fatti di guadagnare tempo per ottenere un'idea precisa poi da sviluppare sul calcolatore.}
Esistono, è vero, autoplacer\index{autoplacer} ed autorouter\index{autorouter} che promettono miracoli nei depliant illustrativi dei grandi CAD, ma è indubbio che si tratti di un lavoro in cui l'intelligenza e l'esperienza giocano ancora un'importanza fondamentale.
FidoCadJ costituisce un sistema molto rapido ed immediato per disegnare piccoli circuiti stampati su scala casalinga. Vedremo qui brevemente come fare per disegnarne uno semplicissimo, ma completo.

Quello che consiglierei a chi si accinge a fare questo lavoro è di avere già un'idea abbastanza precisa di dove piazzare i componenti e come far passare le piste di modo che si incrocino\index{incrocio piste} il meno possibile.

Qui bariamo un po' ed iniziamo direttamente dal risultato che vogliamo ottenere, mostrato in figura~\ref{fig_amplificateur}. Si tratta di un semplice circuito di un amplificatore ad emettitore comune realizzato attorno ad un NPN, tipo BC547 o similari. Sarà utile immaginarsi la piastra come se la vetroresina fosse trasparente, guardando da sopra il circuito, dal lato componenti. A questo proposito, è utile la serigrafia\index{serigrafia} dei componenti che aiuterà a non perdersi nei collegamenti, anche se magari in un progetto casalingo non verrà riportata sulla vetroresina.

\begin{figure}
\centering
\includegraphics[width=.5\textwidth]{amplificateur}
\caption{Un semplicissimo stadio amplificatore ad un transistor NPN connesso ad emettitore comune.}
\label{fig_amplificateur}
\end{figure}

La prima cosa che consiglierei di fare è di piazzare approssimativamente i componenti, nel nostro caso il transistor (biblioteca ``PCB footprints/Semiconduttori 3 terminali/TO92''), i resistori (``PCB footprints/Resistori/Resistore 1/4 W 0,4 i''), i condensatori elettrolitici (``PCB footprints/Condensatori elettrolitici/Vert. diam. 5 passo 2,5''). 
Può essere utile marcare la dimensione totale desiderata del circuito, introducendo un rettangolo vuoto sul layer delle serigrafie (il 3). Per fare questo, basta utilizzare la primitiva rettangolo\index{rettangolo} avendo dapprima selezionato il layer in cui questo va introdotto.
Si dovrebbe ottenere il risultato mostrato in figura~\ref{fig_amplificateur_phase1}.\footnote{FidoCadJ è attualmente distribuito con una nazionalizzazione\index{nazionalizzazione} in italiano\index{italiano}, francese\index{francese}, spagnolo\index{spagnolo}, tedesco\index{tedesco}, inglese\index{inglese} e cinese\index{cinese}. È molto semplice aggiungere una nuova lingua. Nel caso, fatevi sentire! C'è anche bisogno di lavoro per tradurre le librerie (almeno quelle standard), nonché questo manuale.}

\begin{figure}
\includegraphics[width=\textwidth]{amplificateur_phase1}
\caption{I principali componenti vengono posizionati sulla piastrina.}
\label{fig_amplificateur_phase1}
\end{figure}

Si possono quindi introdurre le regioni ramate che forniranno l'alimentazione positiva e negativa. Per fare ciò, bisognerà introdurre dei poligoni\index{poligono} con la primitiva apposita e poi farci sopra doppio click in modalità selezione\index{selezione}, per specificare all'interno della finestra di dialogo che apparirà che quello che vogliamo è un poligono pieno. Fate attenzione a specificare anche il layer\index{layer} corretto, che è il numero 1, ovvero il rame lato saldature. L'uso di un poligono per i piani di alimentazione può essere utile per essere sicuri di disporre di collegamenti a bassa impedenza parassita.\marginpar{Attenzione alle larghezze delle piste: quella che sembra un'autostrada sullo schermo si rivelerà nella realtà dannatamente stretta e pronta a scollarsi dalla vetroresina durante la saldatura.}
Avrà probabilmente la dimensione corretta. Ricordiamoci in fondo che FidoCadJ nasce dai trasferibili\index{trasferibili R41}\dots Con un po' di attenzione, dovrebbe essere possibile ottenere il risultato mostrato in figura~\ref{fig_amplificateur_phase2}.

\begin{figure}
\includegraphics[width=\textwidth]{amplificateur_phase2}
\caption{Abbiamo aggiunto le connessioni di massa e di alimentazione positiva con dei poligoni\index{poligono}.}
\label{fig_amplificateur_phase2}
\end{figure}

Bisognerà poi completare le connessioni elettriche utilizzando la primitiva PCB line\index{PCB line}. Ho scelto di utilizzare uno spessore di 10 unità (1,27~mm), che è una larghezza comoda, per esempio per facilitare le saldature. 
\begin{figure}
\includegraphics[width=\textwidth]{amplificateur_phase3}
\caption{Abbiamo aggiunto le connessioni di massa e di alimentazione positiva con dei poligoni\index{poligono}.}
\label{fig_amplificateur_phase3}
\end{figure}

Ci rendiamo conto di aver bisogno di alcuni connettori: per far entrare il segnale, per prelevarlo e per l'alimentazione. Possiamo tranquillamente utilizzare un footprint previsto per un condensatore al poliestere. 

Già che ci siamo, scriviamo un $+$ ed un $-$ sul lato rame e mettiamo un condensatore ceramico in parallelo all'alimentazione. Mettiamo anche la scritta sul lato superiore. Per scrivere sul lato rame, oltre a selezionare il layer corretto, sarà necessario specchiare le scritte\index{specchiatura scritte}. Questo lo si fa agevolmente all'interno della solita finestra delle proprietà a cui si accede facendo doppio click in modalità selezione sulla stringa da modificare. Sarà necessario fare qualche prova per ottenere le dimensioni dei caratteri corrette. Per avere un'idea, conviene mantenere un rapporto approssimativo di 3/4 tra le dimensioni orizzontali e verticali dei caratteri\index{dimensioni dei caratteri}. La figura~\ref{fig_amplificateur_phase4} mostra il risultato che si è ottenuto con dimensioni del testo di 11 unità in orizzontale e 18 in verticale.

\begin{figure}
\includegraphics[width=\textwidth]{amplificateur_phase4}
\caption{Ecco lo stampato\index{circuito stampato} quasi terminato.}
\label{fig_amplificateur_phase4}
\end{figure}

A questo punto, l'unica cosa che manca è il testo con i nomi dei componenti, che si potrà introdurre sul layer 3, dedicato alla serigrafia. Il programma con il circuito terminato è mostrato in figura~\ref{fig_amplificateur_complet}.

\begin{figure}
\includegraphics[width=\textwidth]{amplificateur_complet}
\caption{Il lavoro finito, con tutte le serigrafie.}
\label{fig_amplificateur_complet}
\end{figure}

Una volta concluso il lavoro, bisognerà probabilmente stampare\index{stampa} il risultato su lucido da proiezione, per poi utilizzare il bromografo\index{bromografo}, oppure metodi tipo ``stira e ammira''\index{stira e ammira}.
Per fare questo, bisogna dapprima rendere invisibili tutti i layer che non si vogliono stampare. Questo lo si fa dalla finestra di dialogo a cui si accede tramite il menu ``Vista/Layer''. Nel nostro caso, basterà rendere invisibile il layer 3, con le serigrafie. Il programma mostrerà solo il rame lato saldature.

Bisognerà quindi stampare quanto si vede sullo schermo (NON adattarlo alla pagina, ovviamente, per rispettare le dimensioni fissate) e selezionando la stampa in bianco e nero per fare in modo che il programma stampi in colore nero pieno tutto il layer. Potrà essere utile specchiare il disegno, a seconda della tecnica che userete poi per fabbricare il circuito stampato\index{circuito stampato}. Dato che il nostro stampato è relativamente piccolo, a grandezza naturale occuperà solo un angolino di un foglio in formato standard ISO-UNI A4\index{A4}, come si può vedere in figura~\ref{fig_amplificateur_impression}.

\begin{figure}
\centering
\fbox{
\includegraphics[width=0.6\textwidth]{amplificateur_impression}}
\caption{Il circuito stampato, così come appare stampato (specchiato) su una pagina in formato ISO-UNI A4.}
\label{fig_amplificateur_impression}
\end{figure}

Per informazione, ecco il codice del circuito stampato che abbiamo usato negli esempi visti sopra (attenzione alle righe un po' lunghe!):
\begin{lstlisting} 
[FIDOCAD]
TY 320 10 18 11 0 4 1 * Darwin Ampli Esempio 08 
TY 85 240 12 8 0 5 1 * + 
TY 44 239 12 8 0 5 1 * - 
PL 35 90 35 225 10 1
PL 55 130 95 130 10 1
PL 250 130 305 130 10 1
PL 215 130 230 130 10 1
PL 195 140 215 130 10 1
PL 115 130 175 130 10 1
MC 155 220 3 0 PCB.R01
MC 75 80 0 0 PCB.R01
MC 270 185 2 0 PCB.R01
MC 270 80 2 0 PCB.R01
MC 230 130 3 0 PCB.CE00
MC 115 130 1 0 PCB.CE00
MC 40 175 0 0 PCB.CC50
PL 190 80 190 120 10 1
PL 190 140 190 185 10 1
PL 155 80 155 120 10 1
PL 155 120 175 130 10 1
PL 155 140 175 130 10 1
PP 30 30 30 105 90 105 130 55 215 55 260 105 320 105 320 30 1
PP 320 240 320 155 260 155 215 205 135 205 90 155 55 155 55 240 1
MC 190 120 0 0 PCB.TO92
MC 305 90 1 0 PCB.CPBX352
MC 55 90 1 0 PCB.CPBX352
MC 80 225 2 0 PCB.CPBX352
TY 290 65 12 8 0 0 3 * Out 
TY 40 60 12 8 0 0 3 * In 
TY 95 225 12 8 0 0 3 * Alimentazione 
TY 70 190 12 8 0 0 3 * C3 
TY 230 95 12 8 0 0 3 * C2 
TY 115 150 12 8 0 0 3 * C1 
TY 120 170 12 8 0 0 3 * R4 
TY 220 200 12 8 0 0 3 * R3 
TY 230 55 12 8 0 0 3 * R2 
TY 100 55 12 8 0 0 3 * R1 
RV 30 5 320 255 3
\end{lstlisting} 

\section{Usiamo un righello}\index{righello}
Durante il disegno di un circuito stampato, è spesso utile misurare con precisione distanze all'interno del proprio progetto. Per esempio, si può voler controllare la larghezza di una pista, la distanza tra due zone ramate o la dimensione totale di una piastra. FidoCadJ offre (a partire dalla versione 0.23.2) la possibilità di piazzare arbitrariamente un righello nella zona di lavoro per facilitare queste cose. Basta fare click con il tasto destro del mouse e trascinare per vedere apparire un righello, come mostrato in figura~\ref{fig_fidocadj_righello}. 
Se l'operazione di click destro e trascinamento è scomoda con il vostro sistema, si può alternativamente fare click con il tasto sinistro e trascinare, mantenendo però premuto il tasto \keyevidence{Shift}.
\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_righello}
\caption{Fare click destro e trascinare per vedere apparire un righello.}
\label{fig_fidocadj_righello}
\end{figure}
La lunghezza totale misurata da FidoCadJ è mostrata in unità logiche\index{unità logiche} ed anche in millimetri. Questo è utile quando il disegno viene stampato in scala 1:1, com'è il caso per i circuiti stampati.

\section{Frecce e stili di tratto}
A partire dalla versione 0.23 di FidoCadJ, delle possibilità sono state aggiunte per quanto riguarda la possibilità di aggiungere delle frecce\index{freccia} alle estremità dei segmenti e delle curve di Bézier.
FidoCadJ offre la possibilità di specificare a quale estremità deve essere introdotta la freccia desiderata, così come lo stile con cui disegnarla. Vengono introdotti anche alcuni stili di tratto tratteggiati\index{tratteggio}, per facilitare i disegni tecnici. La figura~\ref{fig_gyrator} mostra un esempio di uno schema elettrico in cui si è racchiuso uno stadio (un GIC\index{GIC}) in un rettangolo tratteggiato e si è usata una freccia su un'estremità di una curva di Bézier\index{Bézier}. Facendo doppio click su quest'elemento, la finestra dei parametri che viene mostrata è visibile in figura~\ref{fig_parametri_bezier}. Si nota che l'opzione ``Arrow at start'' (freccia all'inizio) è spuntata. Il programma disegnerà una freccia orientata correttamente nel primo punto che definisce la curva. Vi sono alcuni stili di freccia\index{freccia} e di tratto\index{tratteggio} diversi nelle liste attivabili in corrispondenza delle voci ``Arrow style'' e ``Dash style''. Fate qualche prova per capire come funziona la cosa.

\begin{figure}
\includegraphics[width=\textwidth]{gyrator}
\caption{Uno schema elettrico di un GIC in cui sono state utilizzate alcune estensioni proprie a FidoCadJ.}
\label{fig_gyrator}
\end{figure}
\begin{figure}
\centering
\includegraphics[width=.7\textwidth]{parametri_bezier}
\caption{La finestra dei parametri di una curva di Bézier in un disegno FidoCadJ. Si noti la possibilità di specificare un nome ed un valore per quasi ogni elemento del disegno.}
\label{fig_parametri_bezier}
\end{figure}
La possibilità di scegliere un tipo di tratto e di aggiungere delle frecce alle linee non era mai stata prevista nel formato FidoCAD. Questo purtroppo condiziona la compatibilità all'indietro con il FidoCAD\index{FidoCAD} per Windows.
Quando si sceglie di utilizzare un'estensione FidoCadJ bisogna avere ben chiaro in testa cosa si sta facendo. Se si ha bisogno a tutti i costi di mantenere una compatibilità con altri utenti che utilizzano solo FidoCAD\index{FidoCAD} e non FidoCadJ, si può attivare l'opzione ``Modalità di compatibilità con FidoCAD'' all'interno del tab ``Estensioni FidoCadJ'' della finestra ``Preferenze di FidoCadJ'' prima di iniziare a lavorare. In questo modo, sarà impossibile introdurre elementi grafici non previsti da FidoCAD e si otterranno disegni perfettamente compatibili con quest'ultimo. Per maggiori informazioni, consultate il paragrafo~\ref{FCJ_extension}.

\section{Esportazione}
 Una delle cose che mi interessa maggiormente di FidoCadJ è la possibilità di creare piccoli schemi ad uso tipografico. Per questa ragione, ho cercato di permettere l'esportazione\index{esportazione} di disegni anche sotto diversi formati grafici.
 
Per esportare il disegno corrente, basta selezionare la voce ``Esporta verso file grafico'' del menu ``File''. La tabella~\ref{tab_esportazione} mostra una lista dei formati grafici attualmente disponibili per l'esportazione.
\marginpar{Un formato vettoriale\index{formato vettoriale} memorizza le primitive di disegno. Un formato bitmap\index{formato bitmap} lavora su una matrice di punti.}
Per ogni formato, viene specificato espressamente se il formato è vettoriale, oppure bitmap (all'interno della tabella~\ref{tab_esportazione}, ma anche nella finestra di dialogo mostrata da FidoCadJ). Qualora fosse possibile, conviene prediligere sistematicamente l'utilizzo di formati vettoriali per l'esportazione, di modo da ottenere i migliori risultati possibili in tutte le situazioni.\footnote{La struttura del codice di FidoCadJ permette di aggiungere abbastanza agevolmente formati vettoriali di esportazione. Se ve la sentite di partecipare al progetto, contattatemi.}

Per i formati bitmap, può essere utile attivare l'opzione ``Anti aliasing'', per limitare l'effetto di scalettatura che si ottiene nei bordi di linee oblique. 
La risoluzione utilizzata e l'opzione ``Anti aliasing'' non vengono utilizzate durante l'esportazione in un formato vettoriale, mentre invece diventa possibile decidere un fattore di scala.

L'opzione ``Bianco e nero'' permette di stampare ogni layer visibile in nero pieno. Questo è importante quando si debbano per esempio preparare delle pellicole ad uso tipografico, oppure da passare al bromografo.
\begin{table}
\centering
\begin{tabular}{lp{.7\textwidth}}
\toprule
Formato
&
Commento
\\
\midrule
\textsc{jpg}\index{JPG}
&
Diffusissimo formato bitmap. Per il fatto che la compressione utilizzata è lossy\index{compressione lossy}, non si presta per l'esportazione di schemi come quelli di FidoCadJ.
\\

\textsc{png}\index{PNG}
&
Formato bitmap compresso, adatto all'esportazione di schemi e grafici. In mancanza di un formato vettoriale, questo è il formato migliore per esportare un disegno FidoCadJ.
\\

\textsc{svg}\index{SVG}
&
Formato vettoriale standard del W3C. Alcuni browser Internet (come le versioni recenti di Safari\index{Safari}) permettono di visualizzarlo in una pagina web. Permette di usare programmi come Inkscape\index{Inkscape} per ritoccare i disegni forniti da FidoCadJ. Attualmente, ci sono alcune limitazioni per quanto riguarda l'esportazione del testo ruotato o specchiato.
\\

\textsc{eps}\index{EPS}
&
Formato vettoriale Postscript\index{Postscript} incapsulato. Molto utile per chi utilizzi programmi di grafica professionale, oppure voglia includere delle figure in documenti \LaTeX\index{LaTeX@\LaTeX}. Questa è la tecnica per ottenere la figura~\ref{fig_amplificateur}, a pagina~\pageref{fig_amplificateur} (passando per una conversione in \textsc{pdf}, dato che utilizzo \textsc{pdf}\LaTeX\index{pdfLaTeX@\textsc{pdf}\LaTeX}).
\\

\textsc{pgf}\index{PGF}
&
Formato vettoriale da utilizzare direttamente all'interno di un file \LaTeX\index{LaTeX@\LaTeX}, che utilizzi il pacchetto \textsl{pgf}, disponibile nell'archivio CTAN. Questa modalità di esportazione fornisce uno script abbastanza interpretabile e modificabile a mano. Questo permette di introdurre codice \LaTeX\index{LaTeX@\LaTeX} direttamente all'interno del disegno ed è la tecnica adottata per ottenere la figura~\ref{fig_schema}, a pagina~\pageref{fig_schema}.
\\
\textsc{scr}\index{SCR}
&
FidoCadJ, a partire dalla versione 0.21, permette di esportare un disegno verso uno script per CadSoft\index{CadSoft} Eagle\index{Eagle}. Per utilizzare questa possibilità, bisogna installare nella directory \lstinline!lbr! dell'installazione di Eagle la libreria \lstinline!FidoCadJLIB.lbr!, scaricabile dal sito di FidoCadJ. Attualmente, l'esportazione è possibile solo per i simboli elettrici più comuni. Non sono esportati le piazzole e le piste, che saranno dunque assenti nello script Eagle.
\\
\textsc{pdf}\index{PDF}
&
Il celebre formato vettoriale Portable Document Format, di Adobe. Vedi il testo per alcune limitazioni sull'uso dei font\index{font}.
\\
\bottomrule
\end{tabular}
\caption{Lista dei formati di esportazione disponibili con FidoCadJ.}
\label{tab_esportazione}
\end{table}

C'è una cosa però da dire sull'esportazione \textsc{pdf} fatta da FidoCadJ. Il programma non può includere font all'interno del file creato. Questo vuole dire che verranno esportati in maniera identica all'originale solo i disegni che utilizzano alcuni fra i font\index{font} standard tipo 1 a 14 punti:
\begin{itemize}
\item{Courier\index{Courier}: Font con grazie a spaziatura fissa. Vengono convertiti automaticamente in Courier anche le scritte effettuate in Courier New\index{Courier~New}.}
\item{Times\index{Times}: Font con grazie a spaziatura proporzionale. Vengono convertiti in Times anche le scritte in Times New Roman\index{Times~New~Roman} o Times Roman\index{Times~Roman}.}
\item{Helvetica\index{Helvetica}: Font senza grazie a spaziatura proporzionale. Vengono convertite anche le scritte fatte in Arial\index{Arial}.}
\item{Symbol\index{Symbol}: contiene simboli vari.}
\end{itemize}
Tra l'altro, questi font\index{font} sono praticamente di sicuro disponibili ovunque, quindi è una buona idea utilizzarli sistematicamente.

\section{Opzioni linea di comando}
Il programma viene distribuito sotto forma di file \lstinline!.jar!\index{jar}, ovvero un archivio Java.\footnote{Salvo nella versione per Macintosh\index{Macintosh}, per la quale vi è un'applicazione a sé stante.} In molti sistemi operativi, può essere sufficiente fare doppio click sul file per lanciare il programma, a patto di avere una versione recente di Java\index{Java} installata sulla macchina. Nella terminologia Sun\index{Sun}, quello che serve è il cosiddetto JRE\index{JRE}, ovvero il Java Runtime Environment, che è tutto quello che ci vuole per far girare un programma scritto in Java (ma non per scriverlo: per quello ci vuole l'SDK\dots). La versione minima di Java necessaria per utilizzare FidoCadJ è la 1.4, che è in giro ormai da diversi anni.

In qualche caso, potrà essere utile far partire FidoCadJ dalla linea di comando (il terminale\index{terminale} dei sistemi Unix\index{Unix}, oppure il Prompt MS-DOS\index{prompt MS-DOS} per quelli Windows\index{Windows}). Per quello, basta utilizzare il comando \lstinline!java!, con l'opzione \lstinline!-jar!:
\begin{lstlisting}
java -jar fidocadj.jar
\end{lstlisting}

Se un file è specificato nella linea di comando\index{linea di comando}, il programma tenta di aprirlo. Per esempio (su un sistema Unix\index{Unix}):
\begin{lstlisting}
java -jar fidocadj.jar ~/FidoCadJ/test.fcd
\end{lstlisting}

FidoCadJ verrà avviato e cercherà di aprire il file \lstinline!~/FidoCadJ/test.fcd! (sempreché questi esista).
Esistono però altre cose interessanti che FidoCadJ può fare. L'opzione  \lstinline!-h! mostra un elenco delle possibilità a disposizione dell'utente:
\lstset{language=plain,
	basicstyle=\tiny\ttfamily}

\begin{lstlisting}
[davidebucci@Darwin-iMac-G5]$ java -jar fidocadj.jar -h

This is FidoCadJ, version 0.24.
By Davide Bucci, 2007-2012.

Use: java -jar fidocadj.jar [-options] [file] 
where options include:

 -n     Do not start the graphical user interface (headless mode)

 -d     Set the extern library directory
        Usage: -d dir
        where 'dir' is the path of the directory you want to use.

 -c     Convert the given file to a graphical format.
        Usage: -c sx sy eps|pdf|svg|png|jpg|fcd|sch outfile
        If you use this command line option, you *must* specify a FidoCadJ file to convert.
        An alternative is to specify the resolution in pixels per logical unit by
        preceding it by the letter 'r' (without spaces), instead of giving sx and sy.

 -s     Print the size  of the specified file in logical coordinates.

 -h     Print this help and exit.

 [file] The optional (except if you use the -d or -s options) FidoCadJ file to load at
        startup time.

Example: load and convert a FidoCadJ drawing to a 800x600 pixel png file without using the GUI.
java -jar fidocadj.jar -n -c 800 600 png out1.png test1.fcd

Example: load and convert a FidoCadJ drawing to a png file without using the GUI.
         Each FidoCadJ logical unit will be converted in 2 pixels on the image.
java -jar fidocadj.jar -n -c r2 png out2.png test2.fcd


[davidebucci@Darwin-iMac-G5]$
\end{lstlisting}
\lstset{language=FIDOCAD,
	basicstyle=\small\ttfamily}
L'opzione più semplice è \lstinline!-n! (``meno enne''), con cui il programma\dots\ non fa nulla, ovvero non fa partire un'interfaccia utente e non fa \textit{sua sponte} niente di interessante. C'è da rilevare che attivando il programma in questo modo, l'opzione \lstinline!java.awt.headless! viene automaticamente impostata a \lstinline!true!.
Ovviamente, l'opzione \lstinline!-n! non serve a molto da sola, ma è interessante combinata con altre che vedremo tra un poco. Essa infatti permette di lanciare FidoCadJ su un server, oppure all'interno di uno script per effettuare operazioni automatiche.

L'opzione \lstinline!-d! permette di specificare una directory dove pescare delle librerie aggiuntive e, da ultima, l'opzione \lstinline!-c! permette di convertire un file FidoCAD in un formato grafico a scelta fra quelli disponibili. Si tratta quindi dell'opzione che ci interessa maggiormente, soprattutto se utilizzata congiuntamente all'opzione \lstinline!-n!, che evita al programma di far partire un'interfaccia utente grafica.
Prendiamo l'esempio riportato nell'help:

\begin{lstlisting}
java -jar fidocadj.jar -n -c 800 600 png out.png test.fcd
\end{lstlisting}

Il programma viene lanciato senza che l'interfaccia grafica venga mai attivata, esportando in png il file test.fcd. Il file prodotto sarà \lstinline!out.png! ed avrà una dimensione di 800 per 600 pixel.

C'è una versione alternativa dell'opzione \lstinline!-c! che permette di specificare in quanti pixel dev'essere convertita una unità logica. Scegliere un paio di pixel per unità è un modo sicuro per cui gli schemi saranno sempre leggibili (anche se in alcuni casi un po' troppo piccoli). Fattori di conversione non interi sono possibili. Se l'esportazione avviene verso un file vettoriale, \lstinline!-c! permette di moltiplicare tutte le coordinate per il fattore specificato.

Per conoscere la dimensione in unità logiche di uno schema, basta usare l'opzione \lstinline!-s!. Bisogna ricordarsi però che FidoCadJ inserisce un margine di 6 unità logiche, rispetto alle dimensioni calcolate.

Un'altra possibilità interessante, sebbene a stretto rigore sia più una caratteristica di Java\index{Java} che di FidoCadJ, è la possibilità di modificare l'aspetto del programma (che in gergo Java si chiama look \& feel\index{look \& feel}).

Potete giocare con il tipo di aspetto che preferite da linea 
di comando, senza modificare di una virgola il codice. Ecco qualcosa che alcuni utilizzatori Linux\index{Linux} apprezzeranno, il look GTK+\index{GTK+}:
\begin{lstlisting}
java -Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -jar fidocadj.jar 
\end{lstlisting}
Oppure, il classico e non privo di fascino\footnote{La cosa può far sorridere chi è abituato ad interfacce molto curate come il look Aqua utilizzato con MacOSX. Tuttavia, ho visto un sistema di controllo di un sincrotrone funzionare con quest'interfaccia. Posso assicurare che è cosa che incute un certo rispetto.} look \& feel Motif\index{Motif}, che è mostrato in figura~\ref{fig_fidocadj_motif}:
\begin{lstlisting}
java -Dswing.defaultlaf=com.sun.java.swing.plaf.motif.MotifLookAndFeel -jar fidocadj.jar 
\end{lstlisting}
\begin{figure}
\includegraphics[width=\textwidth]{fidocadj_motif}
\caption{L'aspetto del programma sotto MacOSX\index{MacOSX}, utilizzando il look \& feel Motif.}
\label{fig_fidocadj_motif}
\end{figure}
Ovviamente, i comandi sopra elencati vanno usati da terminale, trovandosi nella stessa directory in cui si trova il file \lstinline!fidocad.jar! e scrivendo tutto di seguito sulla stessa riga.
\lstset{language=FIDOCAD,
	basicstyle=\small\ttfamily}


\section{Gestione librerie}
Il programma permette di specificare una directory all'interno della quale sono caricati tutti i file di libreria\index{libreria} (estensione \lstinline!.fcl!). Per farlo, basta andare nel menu ``File/Opzioni'' e specificarla nella riga apposita. Se è presente un file di nome \lstinline!FCDstdlib.fcl!, i suoi contenuti si sostituiscono alla libreria standard\index{libreria!libreria standard} disponibile nel programma. Se è presente un file di nome \lstinline!PCB.fcl!, i suoi contenuti si sostituiscono alla libreria PCB disponibile nel programma.\footnote{Attenzione all'utilizzo delle lettere maiuscole, in particolare se il vostro sistema operativo le differenzia dalle minuscole nella gestione dei file.} Grazie all'accordo di Roby IZ1CYN, ho potuto includere la libreria IHRaM 3.1\index{libreria IHRaM} direttamente nel pacchetto contenente FidoCadJ. Questo perché fra le varie librerie messe a punto dagli utilizzatori di FidoCAD e di FidoCadJ mi è parsa la migliore, la più completa e razionale. Se comunque all'interno della directory esterna contenente le librerie è disponibile un file chiamato \lstinline!IHRAM.FCL!, questo verrà caricato al posto della versione contenuta in FidoCadJ.

Altri file con estensione \lstinline!.fcl! sono considerati alla stregua di librerie aggiuntive e caricati in memoria oltre alla libreria standard. Tutto questo è fatto all'avvio o quando l'utente configura FidoCadJ per leggere le librerie aggiuntive in un'altra directory. Si può forzare il programma a rileggere le librerie attraverso l'opzione ``Aggiorna librerie'' del menu ``Circuito''.

FidoCadJ permette (come del resto il FidoCAD\index{FidoCAD} originale) di suddividere le macro non standard\marginpar{FidoCAD aveva l'opzione ``Splitta le macro non standard''. FidoCadJ può fare esattamente lo stesso, ma in italiano.}, per permettere anche a chi non avesse la libreria in questione installata di vedere lo stesso il disegno. Per attivare quest'opzione, basta andare nelle preferenze del programma ed attivare la voce corrispondente nel tab ``Estensioni di FidoCadJ'', a seconda che si voglia suddividere le macro durante un salvataggio di un file, oppure durante il copia/incolla. Quest'ultima possibilità può essere utile per esempio quando si mostrano i disegni su un forum o su un gruppo di discussione riportandovi il codice. Attenzione che il comportamento è leggermente diverso in modalità normale, oppure quando la modalità di compatibilità con FidoCAD è attiva. Infatti normalmente sono considerati standard gli elementi delle librerie \lstinline!stdlib!, \lstinline!pcb!, \lstinline!elettrotecnica! e \lstinline!ihram!. Quando la modalità di compatibilità con FidoCAD è attiva, solo la libreria \lstinline!stdlib! viene considerata come standard.

\chapter{Il formato disegni, macro e librerie FidoCadJ}
\label{chap_formato}

In questo capitolo, sarà descritto in dettaglio il formato utilizzato da FidoCAD\index{FidoCAD} e di conseguenza da FidoCadJ\index{FidoCadJ} per memorizzare i disegni. Si tratta di un semplice formato testuale che ha il pregio di essere molto compatto ed efficiente. Il formato non è mai stato descritto dettagliatamente in un documento esaustivo, cerco qui di riassumere tutto quello che ho imparato durante lo studio che ho compiuto. Nel corso dello sviluppo di FidoCadJ, mi sono trovato a dover aggiungere dei dettagli al formato originale. Descriverò qui anche le mie aggiunte. Prima di cominciare, ricordo che a partire dalla versione 0.23.4, FidoCadJ utilizza unicamente l'encoding\index{encoding} UTF-8\index{UTF-8} su tutte le piattaforme.

\section{Descrizione dell'intestazione}
Tutti i file contenenti un disegno in formato FidoCadJ\index{FidoCadJ} iniziano con il tag \lstinline![FIDOCAD]!. Un programma può quindi riconoscere la presenza di comandi FidoCadJ\index{FidoCadJ} riconoscendo quindi questo tag. A questo proposito, FidoCadJ è più tollerante del FidoCAD\index{FidoCAD} originale e riconosce ed interpreta correttamente un file privo dell'intestazione standard\index{intestazione}. Anche comandi frammisti a testo vengono comunque riconosciuti ed interpretati correttamente, a meno che il numero di righe consecutive non corrette non superi un valore fissato internamente al programma (intorno al centinaio). Ciò evita che FidoCadJ macini inutilmente per diversi minuti per esempio tentando di aprire un file binario di grandi dimensioni.

\section{Il sistema di coordinate}
FidoCadJ lavora con un sistema di coordinate\index{sistema di coordinate} molto semplice. In pratica, si ha a disposizione un'area molto grande, identificata però da delle coordinate intere e positive. La lunghezza di ogni unità in $x$ ed in $y$ è fissata a $127\micron$, valore che permette di ottenere una buona risoluzione per i package SMD\index{circuito stampato!SMD} più piccoli, senza tuttavia essere troppo fine per gli utilizzi di tutti i giorni. Detto in termini tipografici, la risoluzione con cui lavora FidoCadJ è 200 dpi.

Il FidoCAD\index{FidoCAD} originale prevedeva due modalità diverse: PCB\index{circuito stampato!PCB} e schema elettrico\index{schema elettrico}.
In FidoCadJ questa differenza è attenuata e compare solamente al momento di stampare un disegno: sarà infatti opportuno indicare al programma di ridimensionare uno schema elettrico per occupare al meglio la dimensione del foglio, altrimenti ne verrà fuori un francobollo.

\section{Primitive di disegno}
\label{sec_primitive}
In FidoCadJ, esistono 11 primitive di disegno e sono le seguenti:
\begin{itemize}
\item Linea \index{linea}
\item Rettangolo pieno o vuoto \index{rettangolo}
\item Testo semplice (obsoleta) 
\item Testo avanzato \index{testo}
\item Poligono pieno o vuoto \index{poligono}
\item Ellisse piena o vuota \index{ellisse}
\item Curva di Bézier \index{Bézier}
\item Connessione elettrica \index{connessione}
\item Piazzola per circuito stampato \index{piazzola per c. s.} 
\item Pista per circuito stampato \index{pista per c. s.}
\item Macro\index{macro}
\end{itemize}
Procederemo ad analizzarne il formato una per una. In generale, ogni elemento\index{elemento} del disegno è identificato da un comando e da una serie di parametri\index{parametri} (di solito numeri interi, oppure stringhe testuali) che si trovano sulla stessa riga, separati da uno spazio.

\subsubsection{Linea}
La primitiva linea\index{linea}\marginpar{I matematici troverebbero probabilmente più appropriato il termine ``segmento''\index{segmento}.}, è identificata dal comando \lstinline!LI!\index{LI} e richiede per la sua definizione solamente le coordinate iniziali, finali ed il layer:
\begin{lstlisting} 
LI x1 y1 x2 y2 l
\end{lstlisting}
il punto $(x_1, y_1)$ rappresenta le coordinate iniziali, $(x_2, y_2)$ quelle finali e $l$ è il layer, indicato con un numero da 0 a 15.

\textbf{Estensione FidoCadJ}: il comando \lstinline!LI!\index{LI} può essere seguito nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ a b c d e nv
\end{lstlisting}
dove $a$ è un intero rappresentante la presenza o l'assenza di frecce agli estremi del segmento (vedere la tabella~\ref{tab_frecce_estremita}), $b$ è un intero identificante lo stile della freccia da utilizzare (vedere la tabella~\ref{tab_frecce_stile}). I parametri $c$ e $d$ forniscono rispettivamente la lunghezza totale e la semilarghezza della freccia da disegnare, mentre $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano rispettivamente il nome ed il valore associati a quest'elemento.

\begin{table}
\centering

\begin{tabular}{ccp{.7\textwidth}}
\toprule
$a$	& Freccia \\
\midrule
0	& nessuna \\
1	& all'inizio\\
2	& alla fine\\
3	& entrambe le estremità\\
\bottomrule
\end{tabular}
\caption{Presenza delle frecce sulle estremità di un segmento o di una curva di Bézier, a seconda del codice $a$.}
\label{tab_frecce_estremita}
\end{table}

\begin{table}
\centering
\begin{tabular}{ccp{.7\textwidth}}
\toprule
$b$	& Stile della freccia \\
\midrule
0	& freccia piena normale \\
1	& freccia piena con trattino \\
2	& freccia vuota\\
3	& freccia vuota con trattino\\
\bottomrule
\end{tabular}
\caption{Stile delle frecce, a seconda del codice $b$.}
\label{tab_frecce_stile}
\end{table}

\subsubsection{Rettangolo pieno o vuoto}
Un rettangolo\index{rettangolo} pieno o vuoto è indicato rispettivamente dai comandi \lstinline!RP!\index{RP} e \lstinline!RV!\index{RV} seguiti dalle coordinate di due vertici sulla diagonale e dal layer.
\begin{lstlisting} 
RP x1 y1 x2 y2 l
RV x1 y1 x2 y2 l
\end{lstlisting}
il punto $(x_1, y_1)$ rappresenta il primo vertice sulla diagonale, $(x_2, y_2)$ il secondo vertice, e $l$ è il layer, indicato con un numero da 0 a 15.

\textbf{Estensione FidoCadJ}: i comandi \lstinline!RP!\index{RP} e \lstinline!RV!\index{RV} possono essere seguiti nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ e nv
\end{lstlisting}
dove $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano rispettivamente il nome ed il valore associati a quest'elemento.


\subsubsection{Testo semplice (obsoleta)}
Il testo semplice\index{testo semplice} è stata la prima primitiva di testo messa a disposizione dalle prime versioni di FidoCAD\index{FidoCAD}. FidoCadJ la riconosce e scrive semplicemente il testo in corpo 12, qualunque sia il livello di zoom\index{zoom} utilizzato.

Dato che questa primitiva è stata considerata obsoleta\index{obsoleta} da Lorenzo Lutti\index{Lorenzo Lutti}, il creatore di FidoCAD\index{FidoCAD}, FidoCadJ fa esattamente lo stesso e, seppure questa venga interpretata correttamente, non è presente nella barra delle primitive. FidoCadJ memorizzerà questo elemento esattamente come se fosse un testo avanzato e fra l'altro utilizzerà il comando \lstinline!TY!\index{TY} nel momento di salvare il file.

Il comando è \lstinline!TE!\index{TE} ed il formato è il seguente:
\begin{lstlisting} 
TE x1 y1 £testo da scrivere
\end{lstlisting}
il punto $(x_1, y_1)$ è dove la stringa ``testo da scrivere'' verrà posizionata. Si noti come l'indicazione del layer è assente. FidoCadJ tratterà quest'oggetto come se fosse posizionato sul layer zero (circuito\index{circuito}).

\subsubsection{Testo avanzato}
La primitiva testo avanzato\index{testo avanzato} permette una flessibilità molto maggiore rispetto alla primitiva testo semplice\index{testo semplice} presentata precedentemente.

Essa è identificata dal comando \lstinline!TY!\index{TY}, seguito da svariati parametri, atti a determinare l'orientamento del testo (testo ruotato\index{testo!ruotato} o specchiato\index{testo!specchiato}), nonché le dimensioni in $x$ e $y$ del font\index{font} utilizzato. Data la quantità di informazioni da fornire, la stringa di comando è abbastanza articolata:
\begin{lstlisting} 
TY x1 y1 sy sx a s l f £testo da scrivere
\end{lstlisting}
il punto $(x_1, y_1)$ è dove la stringa ``testo da scrivere'' verrà posizionata.
Il valore di $s_y$ e $s_x$ indica la dimensione verticale ed orizzontale del testo in unità logiche\index{unità logica}. Ho scelto di fare in modo che FidoCadJ rispetti la dimensione verticale del testo a partire da quella orizzontale, e che deformi il font\index{font} solo se strettamente necessario.
La rotazione del testo è resa possibile dal termine $a$, espresso in gradi sessagesimali, mentre il valore di $s$ determina lo stile del testo\index{stile del testo}, secondo la tabella~\ref{tab_stile_testo}.
Il layer è rappresentato dal solito termine $l$, mentre $f$ indica il font\index{font} da utilizzare, oppure è un asterisco\index{asterisco}, per indicare l'utilizzo del font standard Courier New\index{Courier New} (con grazie, a spaziatura fissa). Qualora il nome del font avesse degli spazi, questi vengono rimpiazzati dal simbolo +\index{+}.

\begin{table}
\centering
\begin{tabular}{llp{.7\textwidth}}
\toprule
Bit
&
Peso
&
Funzione
\\
\midrule
0
&
1
&
Testo in neretto
\\
2
&
4
&
Testo specchiato
\\

\bottomrule
\end{tabular}
\caption{Funzione dei bit nello stile del testo.}
\label{tab_stile_testo}
\end{table}

La lunghezza massima del testo\index{lunghezza massima testo} è di una ottantina di parole. Il conto è fatto in parole e non in caratteri perché nella struttura interna del programma le parole vengono contate separatamente al momento di interpretare la linea.

\subsubsection{Poligono pieno o vuoto}
Un poligono\index{poligono} pieno o vuoto è indicato rispettivamente dai comandi \lstinline!PP!\index{PP} e \lstinline!PV!\index{PV}, seguiti dalle coordinate dei vertici che definiscono il poligono e dal layer.
\begin{lstlisting} 
PP x1 y1 x2 y2 ... l
PV x1 y1 x2 y2 ... l
\end{lstlisting}
i punti $(x_1, y_1)$, $(x_2, y_2)$\dots sono i vertici che definiscono il poligono e $l$ è il layer, indicato con un numero da 0 a 15.
La lunghezza della linea può quindi variare a seconda del numero di vertici presenti.
Il numero massimo di vertici\index{numero massimo di vertici} disponibili è fissato arbitrariamente a 20, per evitare di avere a che fare con linee troppo lunghe. 


\textbf{Estensione FidoCadJ}: i comandi \lstinline!PP!\index{PP} e \lstinline!PV!\index{PV} possono essere seguiti nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ e nv
\end{lstlisting}
dove $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano rispettivamente il nome ed il valore associati a quest'elemento.


\subsubsection{Ellisse piena o vuota}
Un'ellisse\index{ellisse} piena o vuota è indicata rispettivamente dai comandi \lstinline!EP!\index{EP} e \lstinline!EV!\index{EV}, seguiti dalle coordinate di due vertici sulla diagonale e dal layer.
\begin{lstlisting} 
EP x1 y1 x2 y2 l
EV x1 y1 x2 y2 l
\end{lstlisting}
il punto $(x_1, y_1)$ rappresenta il primo vertice sulla diagonale, $(x_2, y_2)$ il secondo vertice, e $l$ è il layer, indicato con un numero da 0 a 15.

\textbf{Estensione FidoCadJ}: \lstinline!EP!\index{EP} e \lstinline!EV!\index{EV} possono essere seguiti nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ e nv
\end{lstlisting}
dove $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano rispettivamente il nome ed il valore associati a quest'elemento.


\subsubsection{Curva di Bézier}
Una curva di Bézier\index{Bézier}, nella sua variante cubica è identificata da quattro vertici, che vengono quindi richiesti dal comando \lstinline!BE!\index{BE}:
\begin{lstlisting} 
BE x1 y1 x2 y2 x3 y3 x4 y4 l
\end{lstlisting}
i punti $P_1\equiv (x_1, y_1)$,  $P_2\equiv (x_2, y_2)$,  $P_3\equiv(x_3, y_3)$ e  $P_4\equiv (x_4, y_4)$ sono i quattro punti di controllo della curva di Bézier\index{Bézier}, mentre $l$ è il layer, indicato con un numero da 0 a 15.
Dati i quattro punti sopra definiti, la curva viene calcolata con la combinazione:
\begin{equation}
B(t)=(1-t)^3P_1+3t(1-t)^2P_2+3t^2(1-t)P_3+t^3P_4
\end{equation}
dove $t\in [0,1]$ è un parametro.


\textbf{Estensione FidoCadJ}: \lstinline!BE!\index{BE} può essere seguito nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ a b c d e nv
\end{lstlisting}
dove $a$ è un intero rappresentante la presenza o l'assenza di frecce agli estremi della curva (vedere la tabella~\ref{tab_frecce_estremita}), $b$ è un intero identificante lo stile della freccia da utilizzare (vedere la tabella~\ref{tab_frecce_stile}). I parametri $c$ e $d$ forniscono rispettivamente la lunghezza totale e la semilarghezza della freccia da disegnare, mentre $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano rispettivamente il nome ed il valore associati a quest'elemento.

\subsubsection{Curva complessa, spline}
Una spline naturale cubica\index{spline} viene creata a partire da un certo numero di vertici. La curva passa in tutti i vertici e viene calcolata in modo che il suo percorso sia molto liscio.\footnote{ \href{http://www.cse.unsw.edu.au/~lambert/splines/natcubic.html}{http://www.cse.unsw.edu.au/~lambert/splines/natcubic.html}}All'interno di FidoCadJ, una spline cubica è identificata dai comandi \lstinline!CV!\index{CV} e \lstinline!CP!\index{CP}:
\begin{lstlisting}
CV aa x1 y1 x2 y2 ... l
CP aa x1 y1 x2 y2 ... l
\end{lstlisting}
il parametro $aa$ è uguale a 1 se la curva è chiusa, o a 0 altrimenti. I punti $(x_1, y_1)$, $(x_2, y_2)$\dots sono i vertici che definiscono la spline e $l$ è il layer, indicato con un numero da 0 a 15.
La lunghezza della linea può quindi variare a seconda del numero di vertici presenti.
Il numero massimo di vertici\index{numero massimo di vertici} disponibili (come con i poligoni) è fissato arbitrariamente ad un centinaio, per evitare di avere a che fare con linee troppo lunghe. Questa primitiva è stata introdotta da FidoCadJ a partire dalla versione 0.24 e non è disponibile in FidoCAD\index{FidoCAD}.

\textbf{Estensione FidoCadJ}: \lstinline!CV!\index{CV} o \lstinline!CP!\index{CP} possono essere seguiti nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ a b c d e nv
\end{lstlisting}
dove $a$ è un intero che indica la presenza o l'assenza di frecce agli estremi della curva (vedere la tabella~\ref{tab_frecce_estremita}), $b$ è un intero identificante lo stile della freccia da utilizzare (vedere la tabella~\ref{tab_frecce_stile}). I parametri $c$ e $d$ forniscono rispettivamente la lunghezza totale e la semilarghezza della freccia da disegnare, mentre $e$ è un intero che fornisce lo stile del tratteggio. Se $nv$ è uguale a 1, la linea \lstinline!FCJ! dev'essere seguita da due comandi \lstinline!TY! che specificano  il nome ed il valore associati.

\subsubsection{Connessione elettrica}
La primitiva connessione elettrica\index{connessione} è semplicemente un circoletto pieno di dimensione costante e va utilizzata per rappresentare una connessione in uno schema elettrico. È identificata dal comando \lstinline!SA!\index{SA} e richiede unicamente le coordinate ed il layer:
\begin{lstlisting} 
SA x1 y1 l
\end{lstlisting}
Con FidoCadJ, il diametro del circoletto può essere modificato nel menu ``Opzioni''.

\textbf{Estensione FidoCadJ}: \lstinline!SA!\index{SA} può essere seguito nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ 
\end{lstlisting}
Se \lstinline!FCJ! è presente, i due comandi successivi devono essere \lstinline!TY! che specificano il nome ed il valore da associare a quest'elemento.

\subsubsection{Piazzola per circuito stampato}
Una piazzola per circuito stampato\index{piazzola per c. s.} è identificata dal comando \lstinline!PA!\index{PA} ed è caratterizzata dal suo stile (rotondo, rettangolare, rettangolare con spigoli arrotondati) e dalla dimensione del foro interno:
\begin{lstlisting} 
PA x1 y1 dx dy si st l
\end{lstlisting}
Il punto $(x_1, y_1)$ rappresenta la posizione della piazzola, $d_x$ è la larghezza secondo $x$ della piazzola, $d_y$ l'altezza lungo $y$. Il valore di $s_i$ è il diametro interno del foro e $s_t$ è lo stile della piazzola:
\begin{itemize}
\item[0] piazzola ovale
\item[1] piazzola rettangolare
\item[2] piazzola rettangolare con spigoli arrotondati
\end{itemize}
Il valore di $l$ indica invece il layer all'interno del quale si trova la piazzola.

\textbf{Estensione FidoCadJ}: \lstinline!PA!\index{PA} può essere seguito nella riga successiva da un'estensione:
\begin{lstlisting} 
FCJ 
\end{lstlisting}
Se \lstinline!FCJ! è presente, i due comandi successivi devono essere \lstinline!TY! che specificano il nome ed il valore da associare a quest'elemento.


\subsubsection{Pista per circuito stampato}
La pista di circuito stampato\index{pista per c. s.} è sostanzialmente un segmento, di cui si può specificare la larghezza. Gli estremi del segmento sono sempre arrotondati, per semplificare la connessione con altre piste del circuito stampato. Il comando da utilizzare è \lstinline!PL!\index{PL}, con il formato seguente:
\begin{lstlisting} 
PL x1 y1 x2 y2 di l
\end{lstlisting}

La pista viene tracciata tra i punti $(x_1, y_1)$ e $(x_2, y_2)$, con spessore totale $d_i$. Il layer utilizzato è $l$.

\textbf{Estensione FidoCadJ}: \lstinline!PL!\index{PL} può essere seguito nella riga successiva da un'estensione:

\begin{lstlisting} 
FCJ 
\end{lstlisting}
Se \lstinline!FCJ! è presente, i due comandi successivi sono \lstinline!TY! che specificano il nome ed il valore da associare.


\subsubsection{Chiamata di una macro}
Una macro\index{macro} è un disegno o un simbolo presente all'interno di una libreria. Tipicamente, i simboli elettrici più frequenti sono rappresentati in questa maniera.
Il comando per realizzare una chiamata di una macro è \lstinline!MC!\index{MC}, e la chiamata avviene nella maniera seguente:
\begin{lstlisting} 
MC x1 y1 o m n
\end{lstlisting}
La macro viene disegnata nel punto $(x_1, y_1)$, l'orientazione è definito dal valore di $o$ (moltiplicato per 90°) e se $m$ è uguale a 1, la macro viene specchiata. L'ultimo parametro, $n$ è il nome della macro all'interno di una libreria, specificata come libreria.codice.


\textbf{Estensione FidoCadJ}: \lstinline!MC!\index{MC} può essere seguito nella riga successiva da un'estensione \lstinline!FCJ!. In questo caso, i due comandi successivi devono essere \lstinline!TY!\index{TY} che specificano il nome ed il valore da associare alla macro.

\section{Estensioni di FidoCadJ}
\label{FCJ_extension}
A partire dalla versione 0.21, FidoCadJ ha introdotto delle estensioni\index{estensione FidoCadJ} al formato FidoCAD originale, che nel codice sono identificate dal comando \lstinline!FCJ!\index{FCJ}. 
La presenza di un comando \lstinline!FCJ!\index{FCJ} indica in generale che il comando precedente non è terminato, ma che ulteriori informazioni restano da prendere in conto.
Ecco un esempio:
\begin{lstlisting} 
[FIDOCAD]
MC 40 30 0 0 080
FCJ
TY 50 35 4 3 0 0 0 * R1
TY 50 40 4 3 0 0 0 * 47k
\end{lstlisting}
La presenza del comando \lstinline!FCJ! indica che i campi indicanti il nome ed il valore sono specificati dai due comandi \lstinline!TY! nelle linee che seguono immediatamente \lstinline!FCJ!. Solo le coordinate ed i font dei due comandi \lstinline!TY! sono utilizzati.

Questo modo di procedere ha il vantaggio che se un file contenente un'estensione di questo tipo viene letto da FidoCAD\index{FidoCAD}, quest'ultimo ignorerà le linee contenenti  \lstinline!FCJ! (emettendo un messaggio di errore), ma il disegno ottenuto sarà in qualche modo simile a quello che appare su FidoCadJ (vedere il paragrafo~\ref{FCJ_extension}).

\begin{figure}
\includegraphics[width=\textwidth]{gyrator_n}
\caption{La figura~\ref{fig_gyrator} come probabilmente apparirebbe letta con FidoCAD.}
\label{fig_gyrator_n}
\end{figure}
FidoCadJ dispone di una modalità ``compatibilità con FidoCAD'' all'interno della quale verranno disabilitate le estensioni, di modo da risultare compatibile con il FidoCAD originale. 
In caso contrario, FidoCAD\index{FidoCAD} leggerà ancora (fornendo un messaggio di errore) i file prodotti da FidoCadJ, ma le informazioni addizionali di cui fa uso FidoCadJ non saranno prese in conto nei disegni. Naturalmente, questo limita di molto le possibilità di FidoCadJ, perché si rimane bloccati a quello che poteva fare il vecchio FidoCAD.\footnote{Se la modalità ``compatibilità con FidoCAD'' viene attivata con un disegno già presente, il disegno non sarà modificato, ma le eventuali estensioni non saranno salvate con il codice. C'è quindi il rischio di perdere qualche configurazione. }
Una seconda difficoltà è che FidoCadJ utilizza sempre ed in ogni caso l'encoding\index{encoding} dei caratteri UTF-8\index{UTF-8}. Questo costituisce purtroppo una fonte d'incompatibilità con FidoCAD, basato sul vecchio sistema CP-1252\index{CP-1252}. Alcune lettere accentate potranno non visualizzarsi correttamente nei file scambiati fra i due programmi.
Il risultato dipenderà dal contesto: una riga tratteggiata apparirà continua, le frecce eventualmente presenti non saranno disegnate. Il testo associato al nome ed al valore di una macro sarà invece mostrato correttamente.
La figura~\ref{fig_gyrator_n} dovrebbe riassumere quello che si ottiene fornendo a FidoCAD il codice usato per disegnare la figura~\ref{fig_gyrator}. FidoCAD protesterà un po' per via dei comandi che non comprenderà, mancano dei dettagli (il tratteggio e la freccia), ma in linea di massima il disegno è ancora utilizzabile.

A differenza del FidoCAD originale, FidoCadJ permette di salvare un certo numero di informazioni relative alla configurazione del programma. Il comando utilizzato è \lstinline!FJC!\index{FJC} ed è solitamente emesso verso l'inizio del file. I casi trattati sono descritti nei prossimi paragrafi.

\subsection{Configurazione dei layer}
La configurazione dei layer è fatta attraverso il comando  \lstinline!FJC L!\index{FJC L}. Vengono salvaguardate delle informazioni solamente se il layer è stato modificato rispetto alla configurazione standard di FidoCadJ.
\begin{lstlisting} 
FJC L n xxxx yy
\end{lstlisting}
 dove $n$ rappresenta il numero del layer (da 0 a 15), $xxxx$ è un intero a 32 bit contenente le informazioni sul colore RGB. La componente rossa è contenuta nei bit 16-23, quella verde nei bit 8-15 ed il blu nei bit 0-7.
Il valore, decimale, a singola precisione, $yy$ rappresenta la trasparenza del layer, compresa fra 0,0 (completamente trasparente) e 1,0 (completamente opaco).

Una seconda informazione importante è il nome del layer, specificato (se necessario) come segue:
\begin{lstlisting} 
FJC N n aaaaa
\end{lstlisting}
 dove $n$ rappresenta il numero del layer (da 0 a 15), mentre {\tt aaaaa} è il nome del layer da assegnare. Se questa linea non è utilizzata, il nome del layer è quello assegnato per default all'avvio di FidoCadJ e che dipende dalla lingua e dalle configurazioni locali utilizzate dal sistema operativo.
 
\subsection{Configurazione connessione elettrica}
La dimensione del bollino utilizzato per indicare una connessione elettrica può essere modificata dal programma. Quando le estensioni FidoCadJ sono attive, il valore scelto viene salvato nel file con il comando  \lstinline!FJC C!\index{FJC C} nel modo seguente:
\begin{lstlisting} 
FJC C aaaa
\end{lstlisting}
dove $aaaa$ è un valore decimale, a doppia precisione, rappresentante la taglia del bollino in unità logiche.

\subsection{Configurazione larghezza tratto}
La larghezza del pennino usato per il disegno degli schemi elettrici può essere modificata. Il programma fa differenza fra il tratto dei segmenti (primitiva \lstinline!LI!) e delle linee curve (primitive \lstinline!EV! e \lstinline!BE!). Il primo è modificato dal comando \lstinline!FJC A!\index{FJC A}, mentre il secondo dal comando \lstinline!FJC B!\index{FJC B}.
\begin{lstlisting} 
FJC A aaaa
FJC B bbbb
\end{lstlisting}
dove $aaaa$ e $bbbb$ sono costanti decimali, a doppia precisione, rappresentanto la larghezza del tratto (in unità logiche) da utilizzare rispettivamente per il disegno dei segmenti e delle linee curve. La larghezza di default è fissata internamente a 0,5 unità logiche. 

\section{Tolleranza agli errori sintattici}
FidoCadJ è progettato per tollerare eventuali errori\index{tolleranza agli errori} o comandi malformati che vengano forniti al programma. Ovviamente, a meno che non abbiate una sfera di cristallo\index{sfera di cristallo} collegata come periferica USB, il programma non potrà correggere gli errori e si limiterà a saltare (ed eliminare) tutte le linee che li contengono.

Un'eccezione a questo comportamento è dato dal fatto che, per ragioni di compatibilità con le prime versioni di FidoCAD\index{FidoCAD}, alcune primitive possono essere specificate omettendo il layer\index{layer} (verranno in quel caso considerate parte del layer zero, dedicato ai circuiti).

\section{Il formato delle librerie}
La struttura di un file di libreria è molto semplice:

\begin{lstlisting} 
[FIDOLIB Libreria standard]
{Simbologia di base}
[000 Terminale]
LI 100 100 102 100
EV 102 98 106 102
[010 Terminale +]
LI 100 100 102 100
EV 102 98 106 102
LI 103 100 105 100
LI 104 99 104 101
[020 Terminale -]
LI 100 100 102 100
EV 102 98 106 102
LI 103 100 105 100
...
\end{lstlisting}
La prima linea indica fra parentesi quadre\index{parentesi quadre} il nome della libreria (preceduto dal tag FIDOLIB\index{FIDOLIB}). La seconda linea fornisce, fra parentesi graffe, la categoria della libreria all'interno della quale riunire le macro, fornite successivamente.

Ogni macro è formata da un'intestazione\index{intestazione} (fra parentesi quadre) ed una sequenza di comandi. L'intestazione è composta dal codice (che DEVE essere unico all'interno della libreria) e dalla descrizione. Il codice sarà utilizzato all'interno del codice FidoCAD, mentre la descrizione serve solo all'utente per capire di che macro\index{macro} si tratta. I comandi non sono altro che dei disegni FidoCAD, attorno al punto (100,100), utilizzato come origine. Questo punto sarà poi quello che verrà rimappato nel momento in cui la macro verrà introdotta. La macro verrà poi richiamata con la primitiva \lstinline!MC!\index{MC}, con il codice ``libreria.macro''.

Nulla impedisce di richiamare una macro all'interno di un'altra macro. Quello che bisogna evitare, ovviamente, è la ricorsione\index{ricorsione}, ovvero di scrivere una macro che richiama sé stessa.
Una libreria \textit{non deve} contenere nelle sue macro alcuna informazione di configurazione di FidoCadJ. In altre parole, i comandi \lstinline!FJC!\index{FJC} non devono \textit{mai} apparire all'interno di un file di libreria.

\section{Librerie standard}
FidoCadJ contiene al suo interno alcune librerie tradizionalmente fornite con FidoCAD\index{FidoCAD}. In particolare, si tratta della libreria standard\index{libreria standard} e della libreria dedicata ai simboli per i circuiti stampati (PCB)\index{libreria PCB}.

\'E tuttavia possibile modificare il sostituire il contenuto delle librerie interne specificando al programma (menu ``File/Opzioni/Directory Librerie'') una directory contenente le librerie da caricare.
Se un file di nome \lstinline!FCDstdlib.fcl! è presente in questa directory, il suo contenuto sarà utilizzato al posto della libreria standard. Se un file di nome \lstinline!PCB.fcl! è presente, il suo contenuto verrà utilizzato al posto della libreria contenente i simboli da usare nei circuiti stampati.
Librerie contenute in file con un altro nome e con estensione \lstinline!fcl! saranno caricate a fianco delle librerie standard.


\chapter{Conclusioni}
In questo manuale, si è visto come utilizzare FidoCadJ per disegnare uno schema elettrico oppure un semplice circuito stampato. A questo punto, il lettore dovrebbe possedere tutti gli elementi necessari per utilizzare proficuamente FidoCadJ per le proprie esigenze.

Non bisogna credere che FidoCadJ sia uno strumento dedicato solo all'elettronica. Preparando librerie specifiche, diventa possibile creare quasi ogni tipo di disegno bidimensionale e può essere utile in molte situazioni.

Il vantaggio di un programma libero è quello di essere a disposizione di una comunità. Per questo, è molto importante che gli utilizzatori si facciano sentire (se non altro per capire se il progetto merita di essere continuato, ed in che direzione). Non esitate quindi a contattarmi sul forum di Sourceforge! \footnote{\href{https://sourceforge.net/projects/fidocadj/forums/forum/997486}{https://sourceforge.net/projects/fidocadj/forums/forum/997486}}


\appendix

\chapter{Informazioni specifiche per piattaforma}
\label{specifics}
\section{MacOSX}
\subsection{Estensioni}
Una delle critiche più diffuse alle prime versioni di FidoCadJ da parte degli utilizzatori Macintosh (come me, del resto) consisteva nella cattiva integrazione del programma sotto MacOSX. A partire dalla versione 0.21.1, FidoCadJ fa degli sforzi specifici per integrarsi all'interno dell'aspetto e del funzionamento delle applicazioni native.
Per questa ragione, alcuni dettagli del funzionamento del programma sono leggermente diversi quando FidoCadJ si rende conto di essere eseguito su una piattaforma Apple:
\begin{itemize}
\item FidoCadJ utilizza di default il look and feel Quaqua \footnote{\href{http://www.randelshofer.ch/quaqua/}{http://www.randelshofer.ch/quaqua/}}\index{Quaqua} quando lo si utilizza a partire dell'applicazione completa (FidoCadJ.app\index{FidoCadJ.app} e non il file fidocadj.jar\index{fidocadj.jar}). Dato che Quaqua potrebbe rallentare le prestazioni su macchine non recentissime, vi è la possibilità di disattivarlo attraverso le impostazioni del menu Preferenze.
\item La barra dei menu è mostrata al suo posto, ovvero nella parte alta dello schermo.
\item Le voci ``Preferenze'' e ``Informazioni su FidoCadJ'' si trovano al loro posto, ovvero all'interno del menu FidoCadJ.
\item Il programma dichiara al sistema operativo la sua disponibilità ad aprire file di tipo \lstinline!.fcd! Ad essi viene pure associata un'icona che richiama il simbolo del programma e che dovrebbe essere abbastanza evocativa.
\end{itemize}

\subsection{Come scaricare ed eseguire FidoCadJ con MacOSX}
FidoCadJ può funzionare con una versione di MacOSX\index{MacOSX} superiore o eguale alla 10.3.9 (Panther\index{Panther}). Il motivo è presto detto: FidoCadJ richiede per funzionare almeno la versione 1.4 di Java, che Apple\index{Apple} forniva con il suo sistema operativo. Per ragioni probabilmente di economia di mercato, Apple non sembra molto propensa a fornire Java con le ultime release del suo sistema operativo MacOSX\index{MacOSX}. Questo è un componente essenziale per far funzionare FidoCadJ, quindi se vi manca scaricatevelo ed installatelo. Fra l'altro, Apple non permette di distribuire tramite App Store\index{App Store} programmi GPL o basati su tecnologie software che non le sono simpatiche. La mancanza di Java è peraltro una delle ragioni per cui è improbabile che FidoCadJ possa girare su iPad\index{iPad} ed iPhone\index{iPhone}.

Sebbene sia possibile utilizzare il file \lstinline!fidocad.jar! come sotto gli altri sistemi operativi, con MacOSX conviene utilizzare l'applicazione preparata specificatamente per questo sistema operativo. Tutto avviene come con le applicazioni native: basta scaricare l'immagine disco contenente il programma all'indirizzo: 

{\small
\href{http://sourceforge.net/projects/fidocadj/files/FidoCadJ.dmg/download}{http://sourceforge.net/projects/fidocadj/files/FidoCadJ.dmg/download}}\\
aprite l'immagine disco e spostate \lstinline!FidoCadJ.app! all'interno della cartella \lstinline!Applicazioni! da cui sarà  poi disponibile.

Per disinstallare FidoCadJ, sarà sufficiente prelevare \lstinline!FidoCadJ.app! dalla cartella \lstinline!Applicazioni! e spostarlo nel cestino.

\section{Linux}
\subsection{Estensioni}
Non sono state attualmente implementate estensioni dedicate esclusivamente a questa piattaforma.

\subsection{Come scaricare ed eseguire FidoCadJ su un sistema Linux}
\label{installazione_linux}
\textsl{di Roby Pozzato IZ1CYN}\\


Presupposto: avere installato il JRE\index{JRE} 6 di Sun\index{Sun} e/o OpenJDK\index{OpenJDK} 6 JRE\index{JRE} (o versioni precedenti compatibili con le specifiche del programma). Una installazione insoddisfacente di Java si traduce in performance scadenti di FidoCadJ\footnote{N.D.C. Giurin giuretta! E non venite a dirmi che è colpa mia se la vostra distribuzione ha una versione di Java orrenda! }.
Nel paragrafo \ref{inst_testo} descriveremo come installare il programma adoperando esclusivamente comandi da terminale. Nel paragrafo \ref{inst_grafica}, ci baseremo invece sull'interazione tramite un sistema grafico.


\subsection{Su qualunque sistema, da terminale}
\label{inst_testo}
Scarichiamo il programma utilizzando il comando \lstinline!wget!:

\lstset{language=plain,
	basicstyle=\tiny\ttfamily}

\begin{lstlisting}
$ wget http://downloads.sourceforge.net/project/fidocadj/fidocadj.jar?use_mirror=garr
--00:48:18--  http://downloads.sourceforge.net/project/fidocadj/fidocadj.jar?use_mirror=garr
           => `fidocadj.jar?use_mirror=garr'
Risoluzione di downloads.sourceforge.net in corso... 216.34.181.59
Connessione a downloads.sourceforge.net|216.34.181.59:80... connesso.
HTTP richiesta inviata, aspetto la risposta... 302 Found
Posizione: http://garr.dl.sourceforge.net/project/fidocadj/fidocadj.jar [segue]
--00:48:24--  http://garr.dl.sourceforge.net/project/fidocadj/fidocadj.jar
           => `fidocadj.jar'
Risoluzione di garr.dl.sourceforge.net in corso... 193.206.140.34
Connessione a garr.dl.sourceforge.net|193.206.140.34:80... connesso.
HTTP richiesta inviata, aspetto la risposta... 200 OK
Lunghezza: 343,207 (335K) [application/java-archive]

100%[====================================>] 343,207      422.48K/s             

00:48:30 (420.55 KB/s) - "fidocadj.jar" salvato [343207/343207]
$
\end{lstlisting}
\lstset{
	basicstyle=\small\ttfamily}

In alternativa, o in caso di problemi, è ovviamente possibile scaricare il file con qualunque browser dall'indirizzo:


\href{http://sourceforge.net/projects/fidocadj/files/fidocadj.jar/download}{http://sourceforge.net/projects/fidocadj/files/fidocadj.jar/download}

e salvarlo nella propria \lstinline!/home/!


Creiamo una directory (prima diventiamo root\index{root} con \lstinline!su! o \lstinline!sudo -s!):

\begin{lstlisting}
# mkdir /usr/bin/fidocadj
\end{lstlisting}

\dots e ci spostiamo il file scaricato (sostituite \lstinline!<user>! con l'utente che ha scaricato il file):

\begin{lstlisting}
# mv /home/<user>/fidocadj.jar /usr/bin/fidocadj
\end{lstlisting}

Rendiamo il file eseguibile:

\begin{lstlisting}
# chmod +x /usr/bin/fidocadj/fidocadj.jar
\end{lstlisting}

Non dimentichiamo di tornare utenti normali!

\begin{lstlisting}
# exit
\end{lstlisting}

Ed ora possiamo eseguire il programma:

\begin{lstlisting}
$ /usr/bin/fidocadj/fidocadj.jar
$
\end{lstlisting}
%

\subsection{Su un sistema grafico}
\label{inst_grafica}
Nell'esempio è una Ubuntu\index{Ubuntu} 8.04, ma per versioni precedenti o successive, o altri sistemi, non cambiano i concetti:

\begin{itemize}
\item {Scarichiamo il file dal browser, o con Gwget, o simili)}

\item {Lanciamo il nostro File Manager (Nautilus, Konqueror, ecc.) come root. Se non c'è un comando apposito nel menu basta lanciarlo da terminale con il comando:
\begin{lstlisting}
sudo nautilus
\end{lstlisting}
creiamo poi la directory \lstinline!/usr/bin/fidocadj! e spostiamoci il file appena scaricato (sarà in \lstinline!/home/<user>/!)}

\begin{figure}
\centering
\includegraphics[width=.8\textwidth]{permessi}
\caption{La finestra di impostazione dei permessi, con la distribuzione Ubuntu\index{Ubuntu} 8.04.}
\label{fig_permessi}
\end{figure}

\item {Click destro sul file, nella finestra selezioniamo il tab ``Permessi'', aggiungiamo un segno di spunta a fianco della dicitura ``Consentire l'esecuzione del file come programma'', come mostrato nella figura~\ref{fig_permessi}}

\begin{figure}
\centering
\includegraphics[width=.8\textwidth]{java6}
\caption{Impostare l'esecuzione con la macchina virtuale Java nella distribuzione Ubuntu\index{Ubuntu} 8.04.}
\label{fig_java6}
\end{figure}

\item {Selezioniamo la scheda ``Apri con'' e scegliamo ``OpenJDK Java 6 Runtime'' oppure ``Sun Java 6 Runtime'', come visibile nella figura~\ref{fig_java6}.}\footnote{N.D.R. Mi è stato segnalato che utilizzando il runtime OpenJDK si possono incontrare dei problemi nella stampa di disegni su stampanti adoperanti driver CUPS. In caso di problemi, fate qualche prova con Sun JRE 1.4.2, se disponibile.}

\item {Click su ``Chiudi'', e siamo pronti ad eseguire FidoCadJ: un doppio click sull'eseguibile, oppure lo aggiungiamo al menu; il comando da inserire è semplicemente \lstinline!/usr/bin/fidocadj/fidocadj.jar!.}
\end{itemize}



\section{Windows}
\subsection{Estensioni}
A partire dalla versione 0.23, se FidoCadJ viene fatto girare su una piattaforma Windows, viene utilizzato di default il Look and Feel ``Windows''.

\subsection{Come scaricare ed eseguire FidoCadJ con MacOSX}
In molte situazioni classiche, se avete già una macchina virtuale Java installata\footnote{Apple non la fornisce più per default a partire da MacOSX 10.7 Lion, mentre prima incoraggiava l'uso di Java\dots}, basta scaricare il file \lstinline!fidocadj.jar! e far doppio click su di esso. Se scaricandolo il vostro navigatore lo mostrerà come un archivio \lstinline!zip!, probabilmente non avete installato Java sul vostro computer. Oracle permette di scaricare gratuitamente una versione aggiornata di Java:

\href{http://www.java.com/it/download/}{http://www.java.com/it/download/}

%\manualmark 
%\markboth{\spacedlowsmallcaps{\indexname}}% 
%{\spacedlowsmallcaps{\indexname}} 
%\refstepcounter{dummy} 
%\pagestyle{scrheadings} 
%\addcontentsline{toc}{chapter}{\tocEntry{\indexname}} 
\printindex 
\cleardoublepage
\thispagestyle{empty}
\mbox{ }
\vfill
Questo manuale è stato redatto utilizzando \textsc{pdf}\LaTeX\ sotto MacOSX.
I listati sono stati composti utilizzando il pacchetto \href{http://www.ctan.org/tex-archive/macros/latex/contrib/listings/}{listings}. Il pacchetto \href{http://www.ctan.org/tex-archive/graphics/pgf/}{pgf} è stato utilizzato per la figura~\ref{fig_schema}. I pacchetti utilizzati sono disponibili nell'archivio CTAN.

%Il lavoro è composto con il font \emph{Palatino}, di Hermann Zapf. 
%Il font a larghezza fissa è il \emph{Bera Mono}, originariamente sviluppato da 
%Bitstream, Inc. come ``Bitstream Vera''.
\end{document}
